<!doctype html>
<html data-n-head-ssr>
<head>
  <title>åœ¨ Laravel é¡¹ç›®ä¸­ä½¿ç”¨ webpack-encore - ç”°å†™</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="keywords" name="keywords" content="webpack-encore,laravel-mix,laravel"><meta data-n-head="ssr" data-hid="description" name="description" content=""><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="preload" href="/_nuxt/57d87b4.js" as="script"><link rel="preload" href="/_nuxt/bd0e5e3.js" as="script"><link rel="preload" href="/_nuxt/vendors/app.1c1d3c4.css" as="style"><link rel="preload" href="/_nuxt/cdbd5ef.js" as="script"><link rel="preload" href="/_nuxt/app.b45424a.css" as="style"><link rel="preload" href="/_nuxt/3b8046d.js" as="script"><link rel="preload" href="/_nuxt/pages/posts/_slug.05e6505.css" as="style"><link rel="preload" href="/_nuxt/0e907e6.js" as="script"><link rel="stylesheet" href="/_nuxt/vendors/app.1c1d3c4.css"><link rel="stylesheet" href="/_nuxt/app.b45424a.css"><link rel="stylesheet" href="/_nuxt/pages/posts/_slug.05e6505.css">
</head>
<body>
<div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div><nav class="sticky inset-x-0 top-0 z-50 nav" data-v-cd144d6c><div class="container flex mx-auto z-50 justify-between items-center h-full" data-v-cd144d6c><a href="/" class="text-white text-xl font-normal no-underline nuxt-link-active" data-v-cd144d6c>ç”°å†™</a> <div class="ml-auto mr-2 search-bar" data-v-cd144d6c><input placeholder="æœç´¢æ–‡ç« " class="search-input" data-v-cd144d6c> <div class="search-result" style="display:none" data-v-cd144d6c></div></div> <div class="hidden md:flex" data-v-cd144d6c><a href="https://github.com/tianyong90" target="_blank" class="text-white ml-4 font-light no-underline" data-v-cd144d6c>GitHub</a> <a href="https://weibo.com/1707227001" target="_blank" class="text-white ml-4 font-light no-underline" data-v-cd144d6c>å¾®åš</a></div> <span class="md:hidden mdi text-white text-lg dropdown-menu-toggle mdi-menu" data-v-cd144d6c></span> <div class="container flex md:hidden dropdown-menu" style="display:none" data-v-cd144d6c><a href="/open-source" class="dropdown-menu-item" data-v-cd144d6c>
        å¼€æº
      </a> <a href="https://github.com/tianyong90" target="_blank" class="dropdown-menu-item" data-v-cd144d6c>GitHub</a> <a href="https://weibo.com/1707227001" target="_blank" class="dropdown-menu-item" data-v-cd144d6c>å¾®åš</a></div></div></nav> <div class="container mt-4 md:my-4" data-v-27cbca2e><div class="post rounded-lg overflow-hidden bg-white" data-v-27cbca2e><img src="https://raw.githubusercontent.com/tianyong90/blog/gh-pages/_nuxt/posts/%E5%9C%A8-Laravel-%E9%A1%B9%E7%9B%AE%E4%B8%AD%E4%BD%BF%E7%94%A8-webpack-encore//encore.png" loading="lazy" class="w-full cover-image" data-v-27cbca2e> <div class="px-4 md:px-8 py-2" data-v-27cbca2e><div class="mb-4" data-v-27cbca2e><h1 class="text-gray-800 text-xl font-normal" data-v-27cbca2e>åœ¨ Laravel é¡¹ç›®ä¸­ä½¿ç”¨ webpack-encore</h1> <div class="text-gray-700 text-xs post-date" data-v-27cbca2e>2019-07-07</div></div> <div class="markdown-body" data-v-27cbca2e><p>çœ‹è¿‡æˆ‘ä¹‹å‰å†™è¿‡çš„åšå®¢çš„åº”è¯¥çŸ¥é“æˆ‘ä¸€ç›´æ˜¯ laravel-mix çš„æ­»å¿ ç²‰ï¼Œæœ‰å¥½å‡ ç¯‡æ–‡ç« éƒ½æ˜¯å…³äºå®ƒçš„ã€‚æ¯æ¯æåˆ° laravel-mix æ—¶æ›´æ˜¯ä¸åæº¢ç¾ä¹‹è¯ã€‚ç„¶è€Œå°±åœ¨å¤§æ¦‚ä¸€ä¸ªæœˆå‰ï¼Œæˆ‘å´å†³å®šä¸å†ä½¿ç”¨å®ƒï¼Œè€Œè½¬æŠ• webpack-encore é˜µè¥ã€‚</p>
<p>è‡³äºä¸ºä»€ä¹ˆæ”¾å¼ƒ laravel-mixï¼Œä¸»è¦æ˜¯å› ä¸ºå®ƒçš„ç»´æŠ¤çŠ¶å†µå ªå¿§ï¼Œä¸ä»…æ›´æ–°èŠ‚å¥ç¼“æ…¢ï¼Œè®¸å¤š Issue ä¹…æ‚¬æœªå†³ï¼Œæ›´é‡è¦çš„æ˜¯ï¼Œä½œè€…ä¼¼ä¹å°†å¾ˆå¤š bug å®Œå…¨å¯„å¸Œæœ›äº webpack5ï¼Œå“ªæ€•æœ‰çƒ­å¿ƒäººå£« PR äº†ï¼Œä¹Ÿé€šå¸¸è¢«å…³æ‰ï¼Œç„¶åå›å¤è¯´â€œå…„ deiï¼Œè¿™ä¸ªå‘ç­‰ webpack5 å‡ºæ¥å°±å¥½äº†ï¼Œæˆ‘ä¹‹å‰è¯•è¿‡æ²¡å¼„å¥½ï¼Œä¼°è®¡ä½ è¿™ä¹Ÿå¡«å¥½å‘ï¼Œå¹²è„†å®‰åˆ†ç‚¹å„¿ç­‰ webpack5 å§â€ï¼ˆä¸æ˜¯åŸè¯ï¼Œä½†å·®ä¸å¤šæ˜¯è¿™æ„æ€ ğŸ˜„ï¼‰ã€‚ä½†æœ€ç»ˆè®©æˆ‘ä¸‹å®šå†³å¿ƒå¯»æ±‚æ›¿ä»£æ–¹æ¡ˆçš„ï¼Œåˆ™æ˜¯è¿™ä¸ª <a href="https://github.com/JeffreyWay/laravel-mix/issues/1914">Issue</a>ï¼Œç»†ç¿»æºç ï¼Œå‘ç°ç›¸å…³åŠŸèƒ½ä¾èµ–çš„è¿˜æ˜¯ extract-text-webpack-pluginï¼Œè€Œè¿™ä¸ªåŒ…ï¼Œæ—©åœ¨ webpack4 å‘å¸ƒä¸ä¹…å°±è¢«å®£å¸ƒåºŸå¼ƒäº†ï¼ˆç°åœ¨å»çœ‹å®ƒçš„å®˜æ–¹ä»“åº“å·²ç»è¢«è®¾ç½®ä¸º archivedï¼‰ï¼Œè€Œä½œè€…ä¼¼ä¹å®Œå…¨æ²¡æœ‰ä½¿ç”¨ mini-css-extract-plugin çš„æ„æ€ã€‚</p>
<p>æ­£æ‰€è°“çˆ±ä¹‹æ·±ï¼Œè´£ä¹‹åˆ‡ï¼Œåœ¨å¯¹ laravel-mix è¡¨ç¤ºå¤±æœ›ä¹‹åï¼Œæˆ‘ç¿»å‡ºäº†è‡ªå·± star å¤šæ—¶çš„å¦ä¸€åŒ… webpack-encoreï¼Œè™½è¯´å¾ˆæ—©å°± star äº†ï¼Œä½†ä¹‹å‰å´æ²¡è¯•ç”¨è¿‡å®ƒï¼Œå¯èƒ½ä¹Ÿæ˜¯å› ä¸ºå¯¹äº laravel-mix çš„åçˆ±ï¼Œç„¶è€Œè¿™æ¬¡ï¼Œä¸è¯•ä¾¿ç½¢ï¼Œè¯•å®Œä¹‹åå¤§æœ‰ç›¸è§æ¨æ™šä¹‹æ„ã€‚</p>
<p><a href="https://symfony.com/doc/current/frontend/encore/simple-example.html">webpack-encore</a> æ˜¯ Symfony å®˜æ–¹çš„å‰ç«¯é›†æˆæ„å»ºå·¥å…·ï¼ŒåŒæ ·æ˜¯åŸºäº webpackï¼Œä½†å®ƒçš„ API è®¾è®¡å¾—æ›´ä¸ºå‹å¥½ï¼Œè€Œä¸”æ–‡æ¡£æ›´å®Œå–„ï¼Œå½“ç„¶æ›´å…³é”®çš„ä¸€ç‚¹æ˜¯ï¼Œå‘æ›´å°‘å•Šâ€¦â€¦ä»å¼€å§‹è¯»å®ƒçš„æ–‡æ¡£ï¼Œå€’æŠŠæ‰‹é‡Œä¸€ä¸ªé¡¹ç›®ä» laravel-mix è¿ç§»åˆ° webpack-encoreï¼Œåªç”¨äº†å‡ ä¸ªå°æ—¶ï¼Œå¹¶ä¸”æœŸé—´ç›¸å½“é¡ºåˆ©ã€‚è€Œæˆ‘è¿ç§»çš„è¿™ä¸ªé¡¹ç›®ï¼Œæ˜¯ä¸€ä¸ª Laravel é¡¹ç›®ï¼Œæ‰€ä»¥ä¸‹é¢å°±åˆ†äº«ä¸‹ï¼Œå¦‚æœåœ¨ Laravel é¡¹ç›®ä¸­ä½¿ç”¨ webpack-encore æ›¿ä»£ laravel-mixã€‚</p>
<h2 id="å®‰è£…ä¾èµ–"><a class="header-anchor" href="#å®‰è£…ä¾èµ–">#</a> å®‰è£…ä¾èµ–</h2>
<p>é¦–å…ˆå½“ç„¶æ˜¯å®‰è£…ä¾èµ–</p>
<!--beforebegin--><div class="language-bash extra-class"><!--afterbegin--><pre v-pre class="language-bash"><code><span class="token function">yarn</span> <span class="token function">add</span> -D @symfony/webpack-encore
</code></pre>
<!--beforeend--></div><!--afterend--><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œwebpack-encore æ²¡æœ‰åƒ laravel-mix é‚£æ ·åœ¨è‡ªå·±å†…éƒ¨ä¾èµ– vue-tempplate-compiler ä¹‹ç±»çš„åŒ…ï¼Œæ‰€ä»¥å¦‚æœè‡ªå·±é¡¹ç›®é‡Œç”¨åŠ¨äº†è¿™äº›ï¼Œéœ€è¦è‡ªå·±åœ¨é¡¹ç›®é‡Œæ‰‹åŠ¨å®‰è£…å¥½ã€‚</p>
<h2 id="é…ç½®-webpack"><a class="header-anchor" href="#é…ç½®-webpack">#</a> é…ç½® webpack</h2>
<p>åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª webpack.config.js æ–‡ä»¶å¹¶åœ¨å…¶ä¸­é…ç½® webpack-encore åŠŸèƒ½ï¼ˆå®é™…ä¸Šå®ƒæœ€ç»ˆä¹Ÿæ˜¯ä¸€ä¸ªæ ‡å‡†çš„ webpack é…ç½®æ–‡ä»¶ï¼‰ï¼Œä»¥æœ€åŸºæœ¬çš„ç©æ³•ä¸ºä¾‹ã€‚</p>
<!--beforebegin--><div class="language-js extra-class"><!--afterbegin--><pre v-pre class="language-js"><code><span class="token keyword">const</span> Encore <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@symfony/webpack-encore'</span><span class="token punctuation">)</span>

Encore
<span class="token comment">// directory where compiled assets will be stored</span>
  <span class="token punctuation">.</span><span class="token function">setOutputPath</span><span class="token punctuation">(</span><span class="token string">'public/js/'</span><span class="token punctuation">)</span>
  <span class="token comment">// public path used by the web server to access the output path</span>
  <span class="token punctuation">.</span><span class="token function">setPublicPath</span><span class="token punctuation">(</span><span class="token string">'/js'</span><span class="token punctuation">)</span>
  <span class="token comment">// only needed for CDN's or sub-directory deploy</span>
  <span class="token comment">//.setManifestKeyPrefix('build/')</span>

  <span class="token comment">/*
   * ENTRY CONFIG
   *
   * Add 1 entry for each "page" of your app
   * (including one that's included on every page - e.g. "app")
   *
   * Each entry will result in one JavaScript file (e.g. app.js)
   * and one CSS file (e.g. app.css) if you JavaScript imports CSS.
   */</span><span class="token punctuation">.</span><span class="token function">addEntry</span><span class="token punctuation">(</span><span class="token string">'app'</span><span class="token punctuation">,</span> <span class="token string">'./resources/js/app.js'</span><span class="token punctuation">)</span>

<span class="token comment">// will require an extra script tag for runtime.js</span>
<span class="token comment">// but, you probably want this, unless you're building a single-page app</span>
  <span class="token punctuation">.</span><span class="token function">enableSingleRuntimeChunk</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token punctuation">.</span><span class="token function">cleanupOutputBeforeBuild</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">enableSourceMaps</span><span class="token punctuation">(</span><span class="token operator">!</span>Encore<span class="token punctuation">.</span><span class="token function">isProduction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// enables hashed filenames (e.g. app.abc123.css)</span>
  <span class="token punctuation">.</span><span class="token function">enableVersioning</span><span class="token punctuation">(</span>Encore<span class="token punctuation">.</span><span class="token function">isProduction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

  <span class="token punctuation">.</span><span class="token function">enableVueLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">enableSassLoader</span><span class="token punctuation">(</span><span class="token parameter">options</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    options<span class="token punctuation">.</span>implementation <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'sass'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// fetch the config, then modify it!</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> Encore<span class="token punctuation">.</span><span class="token function">getWebpackConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// export the final config</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> config
</code></pre>
<!--beforeend--></div><!--afterend--><h2 id="æ–°å¢-php-helper-å‡½æ•°"><a class="header-anchor" href="#æ–°å¢-php-helper-å‡½æ•°">#</a> æ–°å¢ php helper å‡½æ•°</h2>
<p>Laravel è‡ªå¸¦äº†ä¸€ä¸ª mix() å‡½æ•°ç”¨äºå¼•ç”¨ mix ç¼–è¯‘çš„èµ„æºï¼Œä¸ä¹‹ç±»ä¼¼ï¼Œsyfony ä¹Ÿæœ‰è¿™æ ·çš„å‡½æ•°ï¼Œè€Œä¸”æ›´ä¸ºæ–¹ä¾¿ã€‚ä¸ºæ­¤ä½ éœ€è¦åœ¨ Laravel é¡¹ç›®ä¸­è‡ªè¡Œå®ç°è¿™ä¸¤æ–¹æ³•ï¼Œä¸‹é¢æ˜¯æˆ‘å‚è€ƒ symfony é‡Œç›¸å…³æºç æ”¹å†™çš„ï¼Œå¯èƒ½é€»è¾‘ä¸Šå¹¶ä¸ç®—å®Œå–„ï¼Œä½†ä»¥è‡ªå·±ä¸€ä¸ªå¤šæœˆçš„ä½¿ç”¨æƒ…å†µæ¥çœ‹ï¼Œå®ƒä»¬è¡¨ç°è‰¯å¥½ã€‚</p>
<!--beforebegin--><div class="language-php extra-class"><!--afterbegin--><pre v-pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>HtmlString</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * @param  string  $entryName
 * @return HtmlString
 */</span>
<span class="token keyword">function</span> <span class="token function">encore_entry_link_tags</span><span class="token punctuation">(</span>string <span class="token variable">$entryName</span><span class="token punctuation">)</span><span class="token punctuation">:</span> HtmlString
<span class="token punctuation">{</span>
    <span class="token variable">$entryPointsFile</span> <span class="token operator">=</span> <span class="token function">public_path</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'js/entrypoints.json'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$jsonResult</span> <span class="token operator">=</span> <span class="token function">json_decode</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$entryPointsFile</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean constant">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'css'</span><span class="token punctuation">,</span> <span class="token variable">$jsonResult</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'entrypoints'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token variable">$entryName</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token constant">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token variable">$tags</span> <span class="token operator">=</span> <span class="token function">array_map</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token single-quoted-string string">'&lt;link rel="stylesheet" href="'</span><span class="token punctuation">.</span><span class="token variable">$item</span><span class="token punctuation">.</span><span class="token single-quoted-string string">'"/>'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token variable">$jsonResult</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'entrypoints'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token variable">$entryName</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'css'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">HtmlString</span><span class="token punctuation">(</span><span class="token function">implode</span><span class="token punctuation">(</span><span class="token single-quoted-string string">''</span><span class="token punctuation">,</span> <span class="token variable">$tags</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * @param  string  $entryName
 * @return HtmlString
 */</span>
<span class="token keyword">function</span> <span class="token function">encore_entry_script_tags</span><span class="token punctuation">(</span>string <span class="token variable">$entryName</span><span class="token punctuation">)</span><span class="token punctuation">:</span> HtmlString
<span class="token punctuation">{</span>
    <span class="token variable">$entryPointsFile</span> <span class="token operator">=</span> <span class="token function">public_path</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'js/entrypoints.json'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$jsonResult</span> <span class="token operator">=</span> <span class="token function">json_decode</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$entryPointsFile</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean constant">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'js'</span><span class="token punctuation">,</span> <span class="token variable">$jsonResult</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'entrypoints'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token variable">$entryName</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token constant">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token variable">$tags</span> <span class="token operator">=</span> <span class="token function">array_map</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token single-quoted-string string">'&lt;script src="'</span><span class="token punctuation">.</span><span class="token variable">$item</span><span class="token punctuation">.</span><span class="token single-quoted-string string">'">&lt;/script>'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token variable">$jsonResult</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'entrypoints'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token variable">$entryName</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'js'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">HtmlString</span><span class="token punctuation">(</span><span class="token function">implode</span><span class="token punctuation">(</span><span class="token single-quoted-string string">''</span><span class="token punctuation">,</span> <span class="token variable">$tags</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<!--beforeend--></div><!--afterend--><h2 id="ä½¿ç”¨-encore-entry-link-tags-å’Œ-encore-entry-script-tags-å¼•ç”¨ç¼–è¯‘çš„å‰ç«¯èµ„æº"><a class="header-anchor" href="#ä½¿ç”¨-encore-entry-link-tags-å’Œ-encore-entry-script-tags-å¼•ç”¨ç¼–è¯‘çš„å‰ç«¯èµ„æº">#</a> ä½¿ç”¨ <code>encore_entry_link_tags</code> å’Œ <code>encore_entry_script_tags</code> å¼•ç”¨ç¼–è¯‘çš„å‰ç«¯èµ„æº</h2>
<p>åœ¨æ¨¡æ¿é‡Œä½¿ç”¨å‰é¢æ·»åŠ çš„ helper å‡½æ•°å¼•ç”¨èµ„æºï¼Œä½ ä¼šå‘ç°å®ƒæ¯” Laravel è‡ªå¸¦çš„ mix() å‡½æ•°æ›´æ–¹ä¾¿ï¼Œåªéœ€è¦ä¸€ä¸ªå‡½æ•°ï¼Œå°±å¯ä»¥è‡ªåŠ¨å¼•å…¥ vendor.js å’Œ app.js äº†ã€‚</p>
<!--beforebegin--><div class="language-php extra-class"><!--afterbegin--><pre v-pre class="language-php"><code><span class="token operator">&lt;</span><span class="token operator">!</span>doctype html<span class="token operator">></span>
<span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token double-quoted-string string">"{{ app()->getLocale() }}"</span><span class="token operator">></span>
<span class="token operator">&lt;</span>head<span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> Required meta tags <span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token double-quoted-string string">"utf-8"</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token double-quoted-string string">"viewport"</span> content<span class="token operator">=</span><span class="token double-quoted-string string">"width=device-width, initial-scale=1, shrink-to-fit=no"</span><span class="token operator">></span>

    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token constant">CSRF</span> Token <span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token double-quoted-string string">"csrf-token"</span> content<span class="token operator">=</span><span class="token double-quoted-string string">"{{ csrf_token() }}"</span><span class="token operator">></span>

    <span class="token operator">&lt;</span>title<span class="token operator">></span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token function">config</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'app.name'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">></span>

    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> app<span class="token punctuation">.</span>css <span class="token operator">--</span><span class="token operator">></span>
    <span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token function">encore_entry_link_tags</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'app'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">></span>
<span class="token operator">&lt;</span>body<span class="token operator">></span>

    <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token double-quoted-string string">"app"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>

    <span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token function">encore_entry_script_tags</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'app'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span>
</code></pre>
<!--beforeend--></div><!--afterend--><h2 id="ä¿®æ”¹-package-json-ä¸­çš„è„šæœ¬ï¼ˆscriptsï¼‰"><a class="header-anchor" href="#ä¿®æ”¹-package-json-ä¸­çš„è„šæœ¬ï¼ˆscriptsï¼‰">#</a> ä¿®æ”¹ package.json ä¸­çš„è„šæœ¬ï¼ˆscriptsï¼‰</h2>
<p>å› ä¸º laravel é¡¹ç›®é»˜è®¤ package.json ä¸­ develop ç­‰ç›¸å…³çš„è„šæœ¬éƒ½æ˜¯ä½¿ç”¨ laravel-mix çš„ï¼Œä¸ºäº†æ–¹ä¾¿æ—¥å¸¸å¼€å‘ï¼Œç°åœ¨è¦å¯¹å®ƒä»¬è¿›è¡Œä¸€äº›è°ƒæ•´ï¼Œæ”¹ç”¨ webpack-cocoreã€‚è°ƒæ•´åå¤§è‡´å¦‚ä¸‹ï¼Œä½ ä¹Ÿå¯ä»¥æ ¹æ®è‡ªå·±å®é™…åº”ç”¨æƒ…å†µè¿›è¡Œå…¶å®ƒè°ƒæ•´</p>
<!--beforebegin--><div class="language-json extra-class"><!--afterbegin--><pre v-pre class="language-json"><code><span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"dev"</span><span class="token operator">:</span> <span class="token string">"npm run development"</span><span class="token punctuation">,</span>
    <span class="token property">"development"</span><span class="token operator">:</span> <span class="token string">"cross-env NODE_ENV=development encore dev"</span><span class="token punctuation">,</span>
    <span class="token property">"watch"</span><span class="token operator">:</span> <span class="token string">"npm run development -- --watch"</span><span class="token punctuation">,</span>
    <span class="token property">"watch-poll"</span><span class="token operator">:</span> <span class="token string">"npm run watch -- --watch-poll"</span><span class="token punctuation">,</span>
    <span class="token property">"hot"</span><span class="token operator">:</span> <span class="token string">"encore dev-server --port=9001 --hot"</span><span class="token punctuation">,</span>
    <span class="token property">"prod"</span><span class="token operator">:</span> <span class="token string">"npm run production"</span><span class="token punctuation">,</span>
    <span class="token property">"production"</span><span class="token operator">:</span> <span class="token string">"cross-env NODE_ENV=production encore production"</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
<!--beforeend--></div><!--afterend--><h2 id="è¿è¡Œè„šæœ¬ï¼Œæ„‰å¿«æ’¸-bug"><a class="header-anchor" href="#è¿è¡Œè„šæœ¬ï¼Œæ„‰å¿«æ’¸-bug">#</a> è¿è¡Œè„šæœ¬ï¼Œæ„‰å¿«æ’¸ BUG</h2>
<p>åšå®Œå‰é¢çš„è¿™äº›æ­¥éª¤ä¹‹åï¼Œåœ¨ç»ˆç«¯æ‰§è¡Œ <code>yarn run hot</code>ï¼Œæµè§ˆå™¨ä¸­è¾“å…¥é¡¹ç›®ç»‘å®šçš„åŸŸåï¼ˆå¦‚ app.test)ï¼Œå°±å¯ä»¥ä½“éªŒæ–¹ä¾¿é«˜æ•ˆçš„ HMR å¼€å‘äº†ã€‚</p>
<h2 id="åè®°"><a class="header-anchor" href="#åè®°">#</a> åè®°</h2>
<p>ä½¿ç”¨ webpack-encore å·²ç»å¿«ä¸¤ä¸ªæœˆäº†ï¼Œè¿™æœŸé—´æ€»ä½“è¯´æ¥ç›¸å½“é¡ºåˆ©ï¼Œå°å‘è™½ç„¶æœ‰ï¼Œä½†æ²¡ä»€ä¹ˆå¤§å‘ã€‚å» github ä¸Šæ issueï¼Œç»´æŠ¤æˆå‘˜åŸºæœ¬ä¸Šéƒ½å¾ˆå‹å–„è€å¿ƒï¼Œå‡ ä¸ªå°æ—¶å°±ä¼šæœ‰å›å¤ã€‚è¿™ç§æ€åº¦ä¹Ÿè®©æˆ‘å¯¹å®ƒæ›´åŠ æ”¾å¿ƒäº†ï¼Œç›¸ä¿¡å®ƒä¼šæŠ˜è…¾å¾—è¶Šæ¥è¶Šå¥½ã€‚è™½ç„¶ webpack-encore æ˜¯ä½œä¸º Symfony é»˜è®¤é›†æˆå·¥å…·æ¥è®¾è®¡çš„ï¼Œä½†è¿™å¹¶ä¸å¦¨ç¢å®ƒåœ¨ Laravel ä¸­å‘æŒ¥å¼ºå¤§å¨åŠ›ã€‚</p>
<p>ç›¸æ¯”äº laravel-mixï¼Œencore çš„ API ä»¥åŠä¸€äº›é»˜è®¤é…ç½®æ–¹é¢è€ƒè™‘å¾—æ›´ä¸ºç§‘å­¦å’Œå…¨é¢ï¼Œæƒ³è¦é…ç½® vue-loader æˆ–è€…  ts-loader ä¹‹ç±»çš„ï¼Œåªéœ€è¦è°ƒç”¨ç›¸åº”çš„æ–¹æ³•ã€‚å¦å¤–è¿˜æœ‰ç‚¹è®©æˆ‘å…ˆæƒŠè®¶çš„æ˜¯ï¼Œä»–ä»¬ç«Ÿç„¶å¯¹ <code>watchOptions.ignored</code> çš„é»˜è®¤å€¼ä¹Ÿè€ƒè™‘åˆ°äº†ï¼Œé»˜è®¤å¿½ç•¥ /node_modules/ï¼Œé™ä½ CPU å ç”¨ã€‚å½“ç„¶ï¼Œæ›´ä¸ºé‡è¦çš„æ˜¯ï¼Œmix4 é‡Œå› ä¸ºä¸€äº› bug è€Œæ— æ³•ä½¿ç”¨çš„åŠŸèƒ½ï¼Œåœ¨ encore é‡Œå´æ­£å¸¸ï¼Œå¦‚ dynamic importã€‚</p>
<p>æ€»ä¹‹ï¼Œå¦‚æœä½ å·²ç»å‘ç°äº† laravel-mix çš„ç§ç§ä¸è¶³ä½†åˆè‹¦äºæ²¡æ›´å¥½é€‰æ‹©çš„è¯ï¼Œä¸å¦¨è¯•è¯• webpack-encoreï¼Œç›¸ä¿¡ä½ ä¼šå¯¹å®ƒçˆ±ä¸é‡Šæ‰‹ã€‚</p>
</div> <div class="social-share" data-v-27cbca2e></div></div></div> <div class="px-4 md:px-0 navigator" data-v-27cbca2e><a href="/posts/elementui-radio-xiao-gai-zao" class="navigator-btn mr-auto btn-prev" data-v-27cbca2e><span class="mdi mdi-chevron-left" data-v-27cbca2e></span> ä¸Šä¸€ç¯‡
    </a> <a href="/posts/sheng-ming-zai-yu-zhe-teng-wo-yong-nuxt.js-chong-gou-liao-bo-ke" class="navigator-btn ml-auto btn-next" data-v-27cbca2e>ä¸‹ä¸€ç¯‡<span class="mdi mdi-chevron-right" data-v-27cbca2e></span></a></div></div> <footer class="pt-6 pb-4 footer"><div class="container mx-auto"><p class="text-gray-100 text-center">@2019-2020 â™¥ tianyong90</p> <p class="text-gray-100 text-center text-sm">
      å…± 0 ç¯‡æ–‡ç«  æœ€åæ›´æ–°äº 
    </p></div></footer> <div class="btn-back-to-top" style="display:none" data-v-42b8f6b3><i class="mdi mdi-arrow-collapse-up" data-v-42b8f6b3></i></div></div></div></div><script>window.__NUXT__={layout:"default",data:[{title:"åœ¨ Laravel é¡¹ç›®ä¸­ä½¿ç”¨ webpack-encore",date:"2019-07-07T13:47:57.000Z",top_img:"./encore.png",tags:["webpack-encore","laravel-mix","laravel"],categories:["å‰ç«¯"],topImg:"https://raw.githubusercontent.com/tianyong90/blog/gh-pages/_nuxt/posts/%E5%9C%A8-Laravel-%E9%A1%B9%E7%9B%AE%E4%B8%AD%E4%BD%BF%E7%94%A8-webpack-encore//encore.png",html:'<p>çœ‹è¿‡æˆ‘ä¹‹å‰å†™è¿‡çš„åšå®¢çš„åº”è¯¥çŸ¥é“æˆ‘ä¸€ç›´æ˜¯ laravel-mix çš„æ­»å¿ ç²‰ï¼Œæœ‰å¥½å‡ ç¯‡æ–‡ç« éƒ½æ˜¯å…³äºå®ƒçš„ã€‚æ¯æ¯æåˆ° laravel-mix æ—¶æ›´æ˜¯ä¸åæº¢ç¾ä¹‹è¯ã€‚ç„¶è€Œå°±åœ¨å¤§æ¦‚ä¸€ä¸ªæœˆå‰ï¼Œæˆ‘å´å†³å®šä¸å†ä½¿ç”¨å®ƒï¼Œè€Œè½¬æŠ• webpack-encore é˜µè¥ã€‚</p>\n<p>è‡³äºä¸ºä»€ä¹ˆæ”¾å¼ƒ laravel-mixï¼Œä¸»è¦æ˜¯å› ä¸ºå®ƒçš„ç»´æŠ¤çŠ¶å†µå ªå¿§ï¼Œä¸ä»…æ›´æ–°èŠ‚å¥ç¼“æ…¢ï¼Œè®¸å¤š Issue ä¹…æ‚¬æœªå†³ï¼Œæ›´é‡è¦çš„æ˜¯ï¼Œä½œè€…ä¼¼ä¹å°†å¾ˆå¤š bug å®Œå…¨å¯„å¸Œæœ›äº webpack5ï¼Œå“ªæ€•æœ‰çƒ­å¿ƒäººå£« PR äº†ï¼Œä¹Ÿé€šå¸¸è¢«å…³æ‰ï¼Œç„¶åå›å¤è¯´â€œå…„ deiï¼Œè¿™ä¸ªå‘ç­‰ webpack5 å‡ºæ¥å°±å¥½äº†ï¼Œæˆ‘ä¹‹å‰è¯•è¿‡æ²¡å¼„å¥½ï¼Œä¼°è®¡ä½ è¿™ä¹Ÿå¡«å¥½å‘ï¼Œå¹²è„†å®‰åˆ†ç‚¹å„¿ç­‰ webpack5 å§â€ï¼ˆä¸æ˜¯åŸè¯ï¼Œä½†å·®ä¸å¤šæ˜¯è¿™æ„æ€ ğŸ˜„ï¼‰ã€‚ä½†æœ€ç»ˆè®©æˆ‘ä¸‹å®šå†³å¿ƒå¯»æ±‚æ›¿ä»£æ–¹æ¡ˆçš„ï¼Œåˆ™æ˜¯è¿™ä¸ª <a href="https://github.com/JeffreyWay/laravel-mix/issues/1914">Issue</a>ï¼Œç»†ç¿»æºç ï¼Œå‘ç°ç›¸å…³åŠŸèƒ½ä¾èµ–çš„è¿˜æ˜¯ extract-text-webpack-pluginï¼Œè€Œè¿™ä¸ªåŒ…ï¼Œæ—©åœ¨ webpack4 å‘å¸ƒä¸ä¹…å°±è¢«å®£å¸ƒåºŸå¼ƒäº†ï¼ˆç°åœ¨å»çœ‹å®ƒçš„å®˜æ–¹ä»“åº“å·²ç»è¢«è®¾ç½®ä¸º archivedï¼‰ï¼Œè€Œä½œè€…ä¼¼ä¹å®Œå…¨æ²¡æœ‰ä½¿ç”¨ mini-css-extract-plugin çš„æ„æ€ã€‚</p>\n<p>æ­£æ‰€è°“çˆ±ä¹‹æ·±ï¼Œè´£ä¹‹åˆ‡ï¼Œåœ¨å¯¹ laravel-mix è¡¨ç¤ºå¤±æœ›ä¹‹åï¼Œæˆ‘ç¿»å‡ºäº†è‡ªå·± star å¤šæ—¶çš„å¦ä¸€åŒ… webpack-encoreï¼Œè™½è¯´å¾ˆæ—©å°± star äº†ï¼Œä½†ä¹‹å‰å´æ²¡è¯•ç”¨è¿‡å®ƒï¼Œå¯èƒ½ä¹Ÿæ˜¯å› ä¸ºå¯¹äº laravel-mix çš„åçˆ±ï¼Œç„¶è€Œè¿™æ¬¡ï¼Œä¸è¯•ä¾¿ç½¢ï¼Œè¯•å®Œä¹‹åå¤§æœ‰ç›¸è§æ¨æ™šä¹‹æ„ã€‚</p>\n<p><a href="https://symfony.com/doc/current/frontend/encore/simple-example.html">webpack-encore</a> æ˜¯ Symfony å®˜æ–¹çš„å‰ç«¯é›†æˆæ„å»ºå·¥å…·ï¼ŒåŒæ ·æ˜¯åŸºäº webpackï¼Œä½†å®ƒçš„ API è®¾è®¡å¾—æ›´ä¸ºå‹å¥½ï¼Œè€Œä¸”æ–‡æ¡£æ›´å®Œå–„ï¼Œå½“ç„¶æ›´å…³é”®çš„ä¸€ç‚¹æ˜¯ï¼Œå‘æ›´å°‘å•Šâ€¦â€¦ä»å¼€å§‹è¯»å®ƒçš„æ–‡æ¡£ï¼Œå€’æŠŠæ‰‹é‡Œä¸€ä¸ªé¡¹ç›®ä» laravel-mix è¿ç§»åˆ° webpack-encoreï¼Œåªç”¨äº†å‡ ä¸ªå°æ—¶ï¼Œå¹¶ä¸”æœŸé—´ç›¸å½“é¡ºåˆ©ã€‚è€Œæˆ‘è¿ç§»çš„è¿™ä¸ªé¡¹ç›®ï¼Œæ˜¯ä¸€ä¸ª Laravel é¡¹ç›®ï¼Œæ‰€ä»¥ä¸‹é¢å°±åˆ†äº«ä¸‹ï¼Œå¦‚æœåœ¨ Laravel é¡¹ç›®ä¸­ä½¿ç”¨ webpack-encore æ›¿ä»£ laravel-mixã€‚</p>\n<h2 id="å®‰è£…ä¾èµ–"><a class="header-anchor" href="#å®‰è£…ä¾èµ–">#</a> å®‰è£…ä¾èµ–</h2>\n<p>é¦–å…ˆå½“ç„¶æ˜¯å®‰è£…ä¾èµ–</p>\n\x3c!--beforebegin--\x3e<div class="language-bash extra-class">\x3c!--afterbegin--\x3e<pre v-pre class="language-bash"><code><span class="token function">yarn</span> <span class="token function">add</span> -D @symfony/webpack-encore\n</code></pre>\n\x3c!--beforeend--\x3e</div>\x3c!--afterend--\x3e<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œwebpack-encore æ²¡æœ‰åƒ laravel-mix é‚£æ ·åœ¨è‡ªå·±å†…éƒ¨ä¾èµ– vue-tempplate-compiler ä¹‹ç±»çš„åŒ…ï¼Œæ‰€ä»¥å¦‚æœè‡ªå·±é¡¹ç›®é‡Œç”¨åŠ¨äº†è¿™äº›ï¼Œéœ€è¦è‡ªå·±åœ¨é¡¹ç›®é‡Œæ‰‹åŠ¨å®‰è£…å¥½ã€‚</p>\n<h2 id="é…ç½®-webpack"><a class="header-anchor" href="#é…ç½®-webpack">#</a> é…ç½® webpack</h2>\n<p>åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª webpack.config.js æ–‡ä»¶å¹¶åœ¨å…¶ä¸­é…ç½® webpack-encore åŠŸèƒ½ï¼ˆå®é™…ä¸Šå®ƒæœ€ç»ˆä¹Ÿæ˜¯ä¸€ä¸ªæ ‡å‡†çš„ webpack é…ç½®æ–‡ä»¶ï¼‰ï¼Œä»¥æœ€åŸºæœ¬çš„ç©æ³•ä¸ºä¾‹ã€‚</p>\n\x3c!--beforebegin--\x3e<div class="language-js extra-class">\x3c!--afterbegin--\x3e<pre v-pre class="language-js"><code><span class="token keyword">const</span> Encore <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'@symfony/webpack-encore\'</span><span class="token punctuation">)</span>\n\nEncore\n<span class="token comment">// directory where compiled assets will be stored</span>\n  <span class="token punctuation">.</span><span class="token function">setOutputPath</span><span class="token punctuation">(</span><span class="token string">\'public/js/\'</span><span class="token punctuation">)</span>\n  <span class="token comment">// public path used by the web server to access the output path</span>\n  <span class="token punctuation">.</span><span class="token function">setPublicPath</span><span class="token punctuation">(</span><span class="token string">\'/js\'</span><span class="token punctuation">)</span>\n  <span class="token comment">// only needed for CDN\'s or sub-directory deploy</span>\n  <span class="token comment">//.setManifestKeyPrefix(\'build/\')</span>\n\n  <span class="token comment">/*\n   * ENTRY CONFIG\n   *\n   * Add 1 entry for each "page" of your app\n   * (including one that\'s included on every page - e.g. "app")\n   *\n   * Each entry will result in one JavaScript file (e.g. app.js)\n   * and one CSS file (e.g. app.css) if you JavaScript imports CSS.\n   */</span><span class="token punctuation">.</span><span class="token function">addEntry</span><span class="token punctuation">(</span><span class="token string">\'app\'</span><span class="token punctuation">,</span> <span class="token string">\'./resources/js/app.js\'</span><span class="token punctuation">)</span>\n\n<span class="token comment">// will require an extra script tag for runtime.js</span>\n<span class="token comment">// but, you probably want this, unless you\'re building a single-page app</span>\n  <span class="token punctuation">.</span><span class="token function">enableSingleRuntimeChunk</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n\n  <span class="token punctuation">.</span><span class="token function">cleanupOutputBeforeBuild</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">enableSourceMaps</span><span class="token punctuation">(</span><span class="token operator">!</span>Encore<span class="token punctuation">.</span><span class="token function">isProduction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token comment">// enables hashed filenames (e.g. app.abc123.css)</span>\n  <span class="token punctuation">.</span><span class="token function">enableVersioning</span><span class="token punctuation">(</span>Encore<span class="token punctuation">.</span><span class="token function">isProduction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n\n  <span class="token punctuation">.</span><span class="token function">enableVueLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n  <span class="token punctuation">.</span><span class="token function">enableSassLoader</span><span class="token punctuation">(</span><span class="token parameter">options</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    options<span class="token punctuation">.</span>implementation <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'sass\'</span><span class="token punctuation">)</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span>\n\n<span class="token comment">// fetch the config, then modify it!</span>\n<span class="token keyword">const</span> config <span class="token operator">=</span> Encore<span class="token punctuation">.</span><span class="token function">getWebpackConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n\n<span class="token comment">// export the final config</span>\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> config\n</code></pre>\n\x3c!--beforeend--\x3e</div>\x3c!--afterend--\x3e<h2 id="æ–°å¢-php-helper-å‡½æ•°"><a class="header-anchor" href="#æ–°å¢-php-helper-å‡½æ•°">#</a> æ–°å¢ php helper å‡½æ•°</h2>\n<p>Laravel è‡ªå¸¦äº†ä¸€ä¸ª mix() å‡½æ•°ç”¨äºå¼•ç”¨ mix ç¼–è¯‘çš„èµ„æºï¼Œä¸ä¹‹ç±»ä¼¼ï¼Œsyfony ä¹Ÿæœ‰è¿™æ ·çš„å‡½æ•°ï¼Œè€Œä¸”æ›´ä¸ºæ–¹ä¾¿ã€‚ä¸ºæ­¤ä½ éœ€è¦åœ¨ Laravel é¡¹ç›®ä¸­è‡ªè¡Œå®ç°è¿™ä¸¤æ–¹æ³•ï¼Œä¸‹é¢æ˜¯æˆ‘å‚è€ƒ symfony é‡Œç›¸å…³æºç æ”¹å†™çš„ï¼Œå¯èƒ½é€»è¾‘ä¸Šå¹¶ä¸ç®—å®Œå–„ï¼Œä½†ä»¥è‡ªå·±ä¸€ä¸ªå¤šæœˆçš„ä½¿ç”¨æƒ…å†µæ¥çœ‹ï¼Œå®ƒä»¬è¡¨ç°è‰¯å¥½ã€‚</p>\n\x3c!--beforebegin--\x3e<div class="language-php extra-class">\x3c!--afterbegin--\x3e<pre v-pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\\</span>Support<span class="token punctuation">\\</span>HtmlString</span><span class="token punctuation">;</span>\n\n<span class="token comment">/**\n * @param  string  $entryName\n * @return HtmlString\n */</span>\n<span class="token keyword">function</span> <span class="token function">encore_entry_link_tags</span><span class="token punctuation">(</span>string <span class="token variable">$entryName</span><span class="token punctuation">)</span><span class="token punctuation">:</span> HtmlString\n<span class="token punctuation">{</span>\n    <span class="token variable">$entryPointsFile</span> <span class="token operator">=</span> <span class="token function">public_path</span><span class="token punctuation">(</span><span class="token single-quoted-string string">\'js/entrypoints.json\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token variable">$jsonResult</span> <span class="token operator">=</span> <span class="token function">json_decode</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$entryPointsFile</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean constant">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token single-quoted-string string">\'css\'</span><span class="token punctuation">,</span> <span class="token variable">$jsonResult</span><span class="token punctuation">[</span><span class="token single-quoted-string string">\'entrypoints\'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token variable">$entryName</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token constant">null</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token variable">$tags</span> <span class="token operator">=</span> <span class="token function">array_map</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token single-quoted-string string">\'&lt;link rel="stylesheet" href="\'</span><span class="token punctuation">.</span><span class="token variable">$item</span><span class="token punctuation">.</span><span class="token single-quoted-string string">\'"/>\'</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token variable">$jsonResult</span><span class="token punctuation">[</span><span class="token single-quoted-string string">\'entrypoints\'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token variable">$entryName</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token single-quoted-string string">\'css\'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">HtmlString</span><span class="token punctuation">(</span><span class="token function">implode</span><span class="token punctuation">(</span><span class="token single-quoted-string string">\'\'</span><span class="token punctuation">,</span> <span class="token variable">$tags</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">/**\n * @param  string  $entryName\n * @return HtmlString\n */</span>\n<span class="token keyword">function</span> <span class="token function">encore_entry_script_tags</span><span class="token punctuation">(</span>string <span class="token variable">$entryName</span><span class="token punctuation">)</span><span class="token punctuation">:</span> HtmlString\n<span class="token punctuation">{</span>\n    <span class="token variable">$entryPointsFile</span> <span class="token operator">=</span> <span class="token function">public_path</span><span class="token punctuation">(</span><span class="token single-quoted-string string">\'js/entrypoints.json\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token variable">$jsonResult</span> <span class="token operator">=</span> <span class="token function">json_decode</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$entryPointsFile</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean constant">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">array_key_exists</span><span class="token punctuation">(</span><span class="token single-quoted-string string">\'js\'</span><span class="token punctuation">,</span> <span class="token variable">$jsonResult</span><span class="token punctuation">[</span><span class="token single-quoted-string string">\'entrypoints\'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token variable">$entryName</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token constant">null</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token variable">$tags</span> <span class="token operator">=</span> <span class="token function">array_map</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token single-quoted-string string">\'&lt;script src="\'</span><span class="token punctuation">.</span><span class="token variable">$item</span><span class="token punctuation">.</span><span class="token single-quoted-string string">\'">&lt;/script>\'</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token variable">$jsonResult</span><span class="token punctuation">[</span><span class="token single-quoted-string string">\'entrypoints\'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token variable">$entryName</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token single-quoted-string string">\'js\'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">HtmlString</span><span class="token punctuation">(</span><span class="token function">implode</span><span class="token punctuation">(</span><span class="token single-quoted-string string">\'\'</span><span class="token punctuation">,</span> <span class="token variable">$tags</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n\x3c!--beforeend--\x3e</div>\x3c!--afterend--\x3e<h2 id="ä½¿ç”¨-encore-entry-link-tags-å’Œ-encore-entry-script-tags-å¼•ç”¨ç¼–è¯‘çš„å‰ç«¯èµ„æº"><a class="header-anchor" href="#ä½¿ç”¨-encore-entry-link-tags-å’Œ-encore-entry-script-tags-å¼•ç”¨ç¼–è¯‘çš„å‰ç«¯èµ„æº">#</a> ä½¿ç”¨ <code>encore_entry_link_tags</code> å’Œ <code>encore_entry_script_tags</code> å¼•ç”¨ç¼–è¯‘çš„å‰ç«¯èµ„æº</h2>\n<p>åœ¨æ¨¡æ¿é‡Œä½¿ç”¨å‰é¢æ·»åŠ çš„ helper å‡½æ•°å¼•ç”¨èµ„æºï¼Œä½ ä¼šå‘ç°å®ƒæ¯” Laravel è‡ªå¸¦çš„ mix() å‡½æ•°æ›´æ–¹ä¾¿ï¼Œåªéœ€è¦ä¸€ä¸ªå‡½æ•°ï¼Œå°±å¯ä»¥è‡ªåŠ¨å¼•å…¥ vendor.js å’Œ app.js äº†ã€‚</p>\n\x3c!--beforebegin--\x3e<div class="language-php extra-class">\x3c!--afterbegin--\x3e<pre v-pre class="language-php"><code><span class="token operator">&lt;</span><span class="token operator">!</span>doctype html<span class="token operator">></span>\n<span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token double-quoted-string string">"{{ app()->getLocale() }}"</span><span class="token operator">></span>\n<span class="token operator">&lt;</span>head<span class="token operator">></span>\n    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> Required meta tags <span class="token operator">--</span><span class="token operator">></span>\n    <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token double-quoted-string string">"utf-8"</span><span class="token operator">></span>\n    <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token double-quoted-string string">"viewport"</span> content<span class="token operator">=</span><span class="token double-quoted-string string">"width=device-width, initial-scale=1, shrink-to-fit=no"</span><span class="token operator">></span>\n\n    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token constant">CSRF</span> Token <span class="token operator">--</span><span class="token operator">></span>\n    <span class="token operator">&lt;</span>meta name<span class="token operator">=</span><span class="token double-quoted-string string">"csrf-token"</span> content<span class="token operator">=</span><span class="token double-quoted-string string">"{{ csrf_token() }}"</span><span class="token operator">></span>\n\n    <span class="token operator">&lt;</span>title<span class="token operator">></span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token function">config</span><span class="token punctuation">(</span><span class="token single-quoted-string string">\'app.name\'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">></span>\n\n    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> app<span class="token punctuation">.</span>css <span class="token operator">--</span><span class="token operator">></span>\n    <span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token function">encore_entry_link_tags</span><span class="token punctuation">(</span><span class="token single-quoted-string string">\'app\'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>\n<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">></span>\n<span class="token operator">&lt;</span>body<span class="token operator">></span>\n\n    <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token double-quoted-string string">"app"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>\n\n    <span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token function">encore_entry_script_tags</span><span class="token punctuation">(</span><span class="token single-quoted-string string">\'app\'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">}</span>\n<span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span>\n<span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span>\n</code></pre>\n\x3c!--beforeend--\x3e</div>\x3c!--afterend--\x3e<h2 id="ä¿®æ”¹-package-json-ä¸­çš„è„šæœ¬ï¼ˆscriptsï¼‰"><a class="header-anchor" href="#ä¿®æ”¹-package-json-ä¸­çš„è„šæœ¬ï¼ˆscriptsï¼‰">#</a> ä¿®æ”¹ package.json ä¸­çš„è„šæœ¬ï¼ˆscriptsï¼‰</h2>\n<p>å› ä¸º laravel é¡¹ç›®é»˜è®¤ package.json ä¸­ develop ç­‰ç›¸å…³çš„è„šæœ¬éƒ½æ˜¯ä½¿ç”¨ laravel-mix çš„ï¼Œä¸ºäº†æ–¹ä¾¿æ—¥å¸¸å¼€å‘ï¼Œç°åœ¨è¦å¯¹å®ƒä»¬è¿›è¡Œä¸€äº›è°ƒæ•´ï¼Œæ”¹ç”¨ webpack-cocoreã€‚è°ƒæ•´åå¤§è‡´å¦‚ä¸‹ï¼Œä½ ä¹Ÿå¯ä»¥æ ¹æ®è‡ªå·±å®é™…åº”ç”¨æƒ…å†µè¿›è¡Œå…¶å®ƒè°ƒæ•´</p>\n\x3c!--beforebegin--\x3e<div class="language-json extra-class">\x3c!--afterbegin--\x3e<pre v-pre class="language-json"><code><span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token property">"dev"</span><span class="token operator">:</span> <span class="token string">"npm run development"</span><span class="token punctuation">,</span>\n    <span class="token property">"development"</span><span class="token operator">:</span> <span class="token string">"cross-env NODE_ENV=development encore dev"</span><span class="token punctuation">,</span>\n    <span class="token property">"watch"</span><span class="token operator">:</span> <span class="token string">"npm run development -- --watch"</span><span class="token punctuation">,</span>\n    <span class="token property">"watch-poll"</span><span class="token operator">:</span> <span class="token string">"npm run watch -- --watch-poll"</span><span class="token punctuation">,</span>\n    <span class="token property">"hot"</span><span class="token operator">:</span> <span class="token string">"encore dev-server --port=9001 --hot"</span><span class="token punctuation">,</span>\n    <span class="token property">"prod"</span><span class="token operator">:</span> <span class="token string">"npm run production"</span><span class="token punctuation">,</span>\n    <span class="token property">"production"</span><span class="token operator">:</span> <span class="token string">"cross-env NODE_ENV=production encore production"</span>\n<span class="token punctuation">}</span><span class="token punctuation">,</span>\n</code></pre>\n\x3c!--beforeend--\x3e</div>\x3c!--afterend--\x3e<h2 id="è¿è¡Œè„šæœ¬ï¼Œæ„‰å¿«æ’¸-bug"><a class="header-anchor" href="#è¿è¡Œè„šæœ¬ï¼Œæ„‰å¿«æ’¸-bug">#</a> è¿è¡Œè„šæœ¬ï¼Œæ„‰å¿«æ’¸ BUG</h2>\n<p>åšå®Œå‰é¢çš„è¿™äº›æ­¥éª¤ä¹‹åï¼Œåœ¨ç»ˆç«¯æ‰§è¡Œ <code>yarn run hot</code>ï¼Œæµè§ˆå™¨ä¸­è¾“å…¥é¡¹ç›®ç»‘å®šçš„åŸŸåï¼ˆå¦‚ app.test)ï¼Œå°±å¯ä»¥ä½“éªŒæ–¹ä¾¿é«˜æ•ˆçš„ HMR å¼€å‘äº†ã€‚</p>\n<h2 id="åè®°"><a class="header-anchor" href="#åè®°">#</a> åè®°</h2>\n<p>ä½¿ç”¨ webpack-encore å·²ç»å¿«ä¸¤ä¸ªæœˆäº†ï¼Œè¿™æœŸé—´æ€»ä½“è¯´æ¥ç›¸å½“é¡ºåˆ©ï¼Œå°å‘è™½ç„¶æœ‰ï¼Œä½†æ²¡ä»€ä¹ˆå¤§å‘ã€‚å» github ä¸Šæ issueï¼Œç»´æŠ¤æˆå‘˜åŸºæœ¬ä¸Šéƒ½å¾ˆå‹å–„è€å¿ƒï¼Œå‡ ä¸ªå°æ—¶å°±ä¼šæœ‰å›å¤ã€‚è¿™ç§æ€åº¦ä¹Ÿè®©æˆ‘å¯¹å®ƒæ›´åŠ æ”¾å¿ƒäº†ï¼Œç›¸ä¿¡å®ƒä¼šæŠ˜è…¾å¾—è¶Šæ¥è¶Šå¥½ã€‚è™½ç„¶ webpack-encore æ˜¯ä½œä¸º Symfony é»˜è®¤é›†æˆå·¥å…·æ¥è®¾è®¡çš„ï¼Œä½†è¿™å¹¶ä¸å¦¨ç¢å®ƒåœ¨ Laravel ä¸­å‘æŒ¥å¼ºå¤§å¨åŠ›ã€‚</p>\n<p>ç›¸æ¯”äº laravel-mixï¼Œencore çš„ API ä»¥åŠä¸€äº›é»˜è®¤é…ç½®æ–¹é¢è€ƒè™‘å¾—æ›´ä¸ºç§‘å­¦å’Œå…¨é¢ï¼Œæƒ³è¦é…ç½® vue-loader æˆ–è€…  ts-loader ä¹‹ç±»çš„ï¼Œåªéœ€è¦è°ƒç”¨ç›¸åº”çš„æ–¹æ³•ã€‚å¦å¤–è¿˜æœ‰ç‚¹è®©æˆ‘å…ˆæƒŠè®¶çš„æ˜¯ï¼Œä»–ä»¬ç«Ÿç„¶å¯¹ <code>watchOptions.ignored</code> çš„é»˜è®¤å€¼ä¹Ÿè€ƒè™‘åˆ°äº†ï¼Œé»˜è®¤å¿½ç•¥ /node_modules/ï¼Œé™ä½ CPU å ç”¨ã€‚å½“ç„¶ï¼Œæ›´ä¸ºé‡è¦çš„æ˜¯ï¼Œmix4 é‡Œå› ä¸ºä¸€äº› bug è€Œæ— æ³•ä½¿ç”¨çš„åŠŸèƒ½ï¼Œåœ¨ encore é‡Œå´æ­£å¸¸ï¼Œå¦‚ dynamic importã€‚</p>\n<p>æ€»ä¹‹ï¼Œå¦‚æœä½ å·²ç»å‘ç°äº† laravel-mix çš„ç§ç§ä¸è¶³ä½†åˆè‹¦äºæ²¡æ›´å¥½é€‰æ‹©çš„è¯ï¼Œä¸å¦¨è¯•è¯• webpack-encoreï¼Œç›¸ä¿¡ä½ ä¼šå¯¹å®ƒçˆ±ä¸é‡Šæ‰‹ã€‚</p>\n',prevLink:"/posts/elementui-radio-xiao-gai-zao",nextLink:"/posts/sheng-ming-zai-yu-zhe-teng-wo-yong-nuxt.js-chong-gou-liao-bo-ke"}],fetch:[],error:null,state:{dropdownMenuVisible:!1,postCount:0,updatedAt:""},serverRendered:!0,routePath:"/posts/zai-laravel-xiang-mu-zhong-shi-yong-webpack-encore",config:{content:{dbHash:"b25b294c"}}}</script><script src="/_nuxt/57d87b4.js" defer></script><script src="/_nuxt/0e907e6.js" defer></script><script src="/_nuxt/bd0e5e3.js" defer></script><script src="/_nuxt/cdbd5ef.js" defer></script><script src="/_nuxt/3b8046d.js" defer></script>
<script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?d2ba150d5915cb664377726d55cdcaf7";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script>
</body>
</html>
