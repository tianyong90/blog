<!doctype html>
<html data-n-head-ssr>
<head>
  <title>田写</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="description" name="description" content="田勇的博客。技术、生活及其它……"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="preload" href="/_nuxt/59828b2c4bffb7c81201.js" as="script"><link rel="preload" href="/_nuxt/6223bf9cbf412215b016.js" as="script"><link rel="preload" href="/_nuxt/825e626c37db3decba58.css" as="style"><link rel="preload" href="/_nuxt/d21b97b3519b4ca255f4.js" as="script"><link rel="preload" href="/_nuxt/84070847fb940ee8f657.css" as="style"><link rel="preload" href="/_nuxt/fee31bf19e7cb06debd3.js" as="script"><link rel="preload" href="/_nuxt/96a484185b9fc8065fa6.css" as="style"><link rel="preload" href="/_nuxt/9cbe1accf3a8320bdeda.js" as="script"><link rel="stylesheet" href="/_nuxt/825e626c37db3decba58.css"><link rel="stylesheet" href="/_nuxt/84070847fb940ee8f657.css"><link rel="stylesheet" href="/_nuxt/96a484185b9fc8065fa6.css">
  <script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?0f605ed20935d41793ba2696a3a8420e";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script>
</head>
<body>
<div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div><nav class="sticky inset-x-0 top-0 z-50 nav" data-v-3cd6ff92><div class="container flex mx-auto z-50 justify-between items-center h-full" data-v-3cd6ff92><a href="/" class="text-white text-xl font-normal no-underline nuxt-link-active" data-v-3cd6ff92>田写</a> <div class="ml-auto mr-2 search-bar" data-v-3cd6ff92><input placeholder="搜索文章" class="search-input" data-v-3cd6ff92> <div class="search-result" style="display:none" data-v-3cd6ff92></div></div> <div class="hidden md:flex" data-v-3cd6ff92><a href="/open-source" class="text-white ml-4 font-light no-underline" data-v-3cd6ff92>
        开源
      </a> <a href="https://github.com/tianyong90" target="_blank" class="text-white ml-4 font-light no-underline" data-v-3cd6ff92>GitHub</a> <a href="https://weibo.com/1707227001" target="_blank" class="text-white ml-4 font-light no-underline" data-v-3cd6ff92>微博</a></div> <span class="md:hidden mdi text-white text-lg dropdown-menu-toggle mdi-menu" data-v-3cd6ff92></span> <div class="container flex md:hidden dropdown-menu" style="display:none" data-v-3cd6ff92><a href="/open-source" class="dropdown-menu-item" data-v-3cd6ff92>
        开源
      </a> <a href="https://github.com/tianyong90" target="_blank" class="dropdown-menu-item" data-v-3cd6ff92>GitHub</a> <a href="https://weibo.com/1707227001" target="_blank" class="dropdown-menu-item" data-v-3cd6ff92>微博</a></div></div></nav> <div class="container mt-4 md:my-4" data-v-7a2c203a><div class="post rounded-lg overflow-hidden bg-white" data-v-7a2c203a><img src="https://raw.githubusercontent.com/tianyong90/blog/gh-pages/_nuxt/posts/%E4%BD%BF%E7%94%A8-Laravel-%E6%95%B0%E6%8D%AE%E5%A1%AB%E5%85%85%E5%8A%9F%E8%83%BD%E7%94%9F%E6%88%90%E4%B8%AD%E6%96%87%E6%B5%8B%E8%AF%95%E6%95%B0%E6%8D%AE//top_img.jpg" loading="lazy" class="w-full cover-image" data-v-7a2c203a> <div class="px-4 md:px-8 py-2" data-v-7a2c203a><div class="mb-4" data-v-7a2c203a><h1 class="text-gray-800 text-xl font-normal" data-v-7a2c203a>使用 Laravel 数据填充功能生成中文测试数据</h1> <div class="text-gray-700 text-xs post-date" data-v-7a2c203a>2019-03-11</div></div> <div class="markdown-body" data-v-7a2c203a><p>今晚……不对，是昨晚，折腾一个的小项目，发现自动填充的中文数据显示起来总不太美观，于是开始琢磨如何填充中文数据进行测试。</p>
<p>然而一番搜索后惊奇的发现，官方、以及一些非官方的文档均未提及这一功能。期间看到一篇他人的“经验”文章，虽然可以实现这一需求，却要求修改 vendor 目录下 fzaninotto/Faker 包的源码，对于一个中了 Laravel 的“优雅之毒”的人来说，怎能容忍如此风骚的操作？</p>
<p>一定有更好的办法……</p>
<p>继续理清 Laravel 模型工厂原理之后，终于有所进展。发现其实只需要一个小小的修改就可以实现这一功能。</p>
<ul>
<li>根据官方示例的模型工厂代码</li>
</ul>
<!--beforebegin--><div class="language-php extra-class"><!--afterbegin--><pre v-pre class="language-php"><code><span class="token variable">$factory</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">define</span><span class="token punctuation">(</span>App\<span class="token package">Product</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>Faker\<span class="token package">Generator</span> <span class="token variable">$faker</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'user_id'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'name'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$faker</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">name</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'mobile'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$faker</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">phoneNumber</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'province'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$faker</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">state</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'city'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$faker</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">city</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'area'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$faker</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">area</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'address'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$faker</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">streetAddress</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'postcode'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$faker</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">postcode</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<!--beforeend--></div><!--afterend--><ul>
<li>调整后的代码</li>
</ul>
<!--beforebegin--><div class="language-php extra-class"><!--afterbegin--><pre v-pre class="language-php"><code><span class="token variable">$factory</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">define</span><span class="token punctuation">(</span>App\<span class="token package">Address</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$faker</span> <span class="token operator">=</span> Faker\<span class="token package">Factory</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'zh_CN'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'user_id'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'name'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$faker</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">name</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'mobile'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$faker</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">phoneNumber</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'province'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$faker</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">state</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'city'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$faker</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">city</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'area'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$faker</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">area</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'address'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$faker</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">streetAddress</span><span class="token punctuation">,</span>
        <span class="token single-quoted-string string">'postcode'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$faker</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">postcode</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<!--beforeend--></div><!--afterend--><p>调整前，使用依赖注入的 <code>Faker\Generator</code> 是使用的默认语言，即英文。</p>
<p>调整后， <code>Faker\Factory::create('zh_CN')</code> 也会返回一个 <code>Faker\Generator</code>， 但它是使用汉语初始化的。</p>
<p><strong>事实上 Faker 本地化对于中文的支持仍有部分待完善，使用暂时不支持生成随机中文句子或者段落（相应的方法返回的仍然会是英文的），但我相信不久之后会有大牛实现这一些功能。</strong></p>
<p>最后，上图，实际生成数据效果如下：
<img src="https://raw.githubusercontent.com/tianyong90/blog/gh-pages/_nuxt/posts/%E4%BD%BF%E7%94%A8-Laravel-%E6%95%B0%E6%8D%AE%E5%A1%AB%E5%85%85%E5%8A%9F%E8%83%BD%E7%94%9F%E6%88%90%E4%B8%AD%E6%96%87%E6%B5%8B%E8%AF%95%E6%95%B0%E6%8D%AE/result.png" alt="file"></p>
<blockquote>
<p>请别纠结省市区从属关系，数据仅供测试而已 😄</p>
</blockquote>
<p><strong>评论中大牛提醒后发现， Laravel5.4 及更新版本其实已经考虑了这一问题，并设置了相关的配置项 <code>app.faker_locale</code>，只不过在文档和默认的配置文件中看不到这一参数。相关源码在 <code>Illuminate\Database\DatabaseServiceProvider</code> 类中，可以查看源码来判断是否支持这一配置项。对于支持的版本，只需要在 <code>config\app.php</code> 文件中加入 <code>faker_locale => 'zh_CN'</code> 就可以实现了</strong></p>
</div> <div class="social-share" data-v-7a2c203a></div></div></div> <div class="px-4 md:px-0 navigator" data-v-7a2c203a><a href="/posts/intervention-image-zhong-de-yi-ge-xiao-keng-ji-qi-po-jie-zhi-fa" class="navigator-btn mr-auto btn-prev" data-v-7a2c203a><span class="mdi mdi-chevron-left" data-v-7a2c203a></span> 上一篇
    </a> <!----></div></div> <footer class="pt-6 pb-4 footer"><div class="container mx-auto"><p class="text-gray-100 text-center">@2019-2020 ♥ tianyong90</p> <p class="text-gray-100 text-center text-sm">
      共 0 篇文章 最后更新于 
    </p></div></footer> <div class="btn-back-to-top" style="display:none" data-v-23ae968e><i class="mdi mdi-arrow-collapse-up" data-v-23ae968e></i></div></div></div></div><script>window.__NUXT__=function(s){return{layout:"default",data:[{title:"使用 Laravel 数据填充功能生成中文测试数据",date:"2019-03-10T16:38:18.000Z",top_img:"./top_img.jpg",tags:["laravel","数据填充"],categories:["php","Laravel"],topImg:"https://raw.githubusercontent.com/tianyong90/blog/gh-pages/_nuxt/posts/%E4%BD%BF%E7%94%A8-Laravel-%E6%95%B0%E6%8D%AE%E5%A1%AB%E5%85%85%E5%8A%9F%E8%83%BD%E7%94%9F%E6%88%90%E4%B8%AD%E6%96%87%E6%B5%8B%E8%AF%95%E6%95%B0%E6%8D%AE//top_img.jpg",html:'<p>今晚……不对，是昨晚，折腾一个的小项目，发现自动填充的中文数据显示起来总不太美观，于是开始琢磨如何填充中文数据进行测试。</p>\n<p>然而一番搜索后惊奇的发现，官方、以及一些非官方的文档均未提及这一功能。期间看到一篇他人的“经验”文章，虽然可以实现这一需求，却要求修改 vendor 目录下 fzaninotto/Faker 包的源码，对于一个中了 Laravel 的“优雅之毒”的人来说，怎能容忍如此风骚的操作？</p>\n<p>一定有更好的办法……</p>\n<p>继续理清 Laravel 模型工厂原理之后，终于有所进展。发现其实只需要一个小小的修改就可以实现这一功能。</p>\n<ul>\n<li>根据官方示例的模型工厂代码</li>\n</ul>\n\x3c!--beforebegin--\x3e<div class="language-php extra-class">\x3c!--afterbegin--\x3e<pre v-pre class="language-php"><code><span class="token variable">$factory</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">define</span><span class="token punctuation">(</span>App\\<span class="token package">Product</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>Faker\\<span class="token package">Generator</span> <span class="token variable">$faker</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token punctuation">[</span>\n        <span class="token single-quoted-string string">\'user_id\'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">,</span>\n        <span class="token single-quoted-string string">\'name\'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$faker</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">name</span><span class="token punctuation">,</span>\n        <span class="token single-quoted-string string">\'mobile\'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$faker</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">phoneNumber</span><span class="token punctuation">,</span>\n        <span class="token single-quoted-string string">\'province\'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$faker</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">state</span><span class="token punctuation">,</span>\n        <span class="token single-quoted-string string">\'city\'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$faker</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">city</span><span class="token punctuation">,</span>\n        <span class="token single-quoted-string string">\'area\'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$faker</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">area</span><span class="token punctuation">,</span>\n        <span class="token single-quoted-string string">\'address\'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$faker</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">streetAddress</span><span class="token punctuation">,</span>\n        <span class="token single-quoted-string string">\'postcode\'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$faker</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">postcode</span><span class="token punctuation">,</span>\n    <span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n\x3c!--beforeend--\x3e</div>\x3c!--afterend--\x3e<ul>\n<li>调整后的代码</li>\n</ul>\n\x3c!--beforebegin--\x3e<div class="language-php extra-class">\x3c!--afterbegin--\x3e<pre v-pre class="language-php"><code><span class="token variable">$factory</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">define</span><span class="token punctuation">(</span>App\\<span class="token package">Address</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token variable">$faker</span> <span class="token operator">=</span> Faker\\<span class="token package">Factory</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token single-quoted-string string">\'zh_CN\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">return</span> <span class="token punctuation">[</span>\n        <span class="token single-quoted-string string">\'user_id\'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">,</span>\n        <span class="token single-quoted-string string">\'name\'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$faker</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">name</span><span class="token punctuation">,</span>\n        <span class="token single-quoted-string string">\'mobile\'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$faker</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">phoneNumber</span><span class="token punctuation">,</span>\n        <span class="token single-quoted-string string">\'province\'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$faker</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">state</span><span class="token punctuation">,</span>\n        <span class="token single-quoted-string string">\'city\'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$faker</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">city</span><span class="token punctuation">,</span>\n        <span class="token single-quoted-string string">\'area\'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$faker</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">area</span><span class="token punctuation">,</span>\n        <span class="token single-quoted-string string">\'address\'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$faker</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">streetAddress</span><span class="token punctuation">,</span>\n        <span class="token single-quoted-string string">\'postcode\'</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token variable">$faker</span><span class="token operator">-</span><span class="token operator">></span><span class="token property">postcode</span><span class="token punctuation">,</span>\n    <span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n\x3c!--beforeend--\x3e</div>\x3c!--afterend--\x3e<p>调整前，使用依赖注入的 <code>Faker\\Generator</code> 是使用的默认语言，即英文。</p>\n<p>调整后， <code>Faker\\Factory::create(\'zh_CN\')</code> 也会返回一个 <code>Faker\\Generator</code>， 但它是使用汉语初始化的。</p>\n<p><strong>事实上 Faker 本地化对于中文的支持仍有部分待完善，使用暂时不支持生成随机中文句子或者段落（相应的方法返回的仍然会是英文的），但我相信不久之后会有大牛实现这一些功能。</strong></p>\n<p>最后，上图，实际生成数据效果如下：\n<img src="https://raw.githubusercontent.com/tianyong90/blog/gh-pages/_nuxt/posts/%E4%BD%BF%E7%94%A8-Laravel-%E6%95%B0%E6%8D%AE%E5%A1%AB%E5%85%85%E5%8A%9F%E8%83%BD%E7%94%9F%E6%88%90%E4%B8%AD%E6%96%87%E6%B5%8B%E8%AF%95%E6%95%B0%E6%8D%AE/result.png" alt="file"></p>\n<blockquote>\n<p>请别纠结省市区从属关系，数据仅供测试而已 😄</p>\n</blockquote>\n<p><strong>评论中大牛提醒后发现， Laravel5.4 及更新版本其实已经考虑了这一问题，并设置了相关的配置项 <code>app.faker_locale</code>，只不过在文档和默认的配置文件中看不到这一参数。相关源码在 <code>Illuminate\\Database\\DatabaseServiceProvider</code> 类中，可以查看源码来判断是否支持这一配置项。对于支持的版本，只需要在 <code>config\\app.php</code> 文件中加入 <code>faker_locale =&gt; \'zh_CN\'</code> 就可以实现了</strong></p>\n',prevLink:"/posts/intervention-image-zhong-de-yi-ge-xiao-keng-ji-qi-po-jie-zhi-fa",nextLink:s}],fetch:[],error:s,state:{dropdownMenuVisible:!1,postCount:0,updatedAt:""},serverRendered:!0,routePath:"/posts/shi-yong-laravel-shu-ju-tian-chong-gong-neng-sheng-cheng-zhong-wen-ce-shi-shu-ju"}}(null)</script><script src="/_nuxt/59828b2c4bffb7c81201.js" defer></script><script src="/_nuxt/9cbe1accf3a8320bdeda.js" defer></script><script src="/_nuxt/6223bf9cbf412215b016.js" defer></script><script src="/_nuxt/d21b97b3519b4ca255f4.js" defer></script><script src="/_nuxt/fee31bf19e7cb06debd3.js" defer></script>
</body>
</html>
