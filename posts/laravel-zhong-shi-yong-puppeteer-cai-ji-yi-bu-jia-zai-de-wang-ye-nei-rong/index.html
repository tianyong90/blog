<!doctype html>
<html data-n-head-ssr>
<head>
  <title>田写</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="description" name="description" content="田勇的博客。技术、生活及其它……"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="preload" href="/_nuxt/01bcce01f8c790f5d374.js" as="script"><link rel="preload" href="/_nuxt/105c752e7a97439a686c.js" as="script"><link rel="preload" href="/_nuxt/825e626c37db3decba58.css" as="style"><link rel="preload" href="/_nuxt/21062646b9e158167d36.js" as="script"><link rel="preload" href="/_nuxt/0fdbd6daeffcd4f7250c.css" as="style"><link rel="preload" href="/_nuxt/d1fd124a92a019d40dff.js" as="script"><link rel="preload" href="/_nuxt/3e147d9494bb78de7c6e.css" as="style"><link rel="preload" href="/_nuxt/07bd7fabb502977506dc.js" as="script"><link rel="stylesheet" href="/_nuxt/825e626c37db3decba58.css"><link rel="stylesheet" href="/_nuxt/0fdbd6daeffcd4f7250c.css"><link rel="stylesheet" href="/_nuxt/3e147d9494bb78de7c6e.css">
  <script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?0f605ed20935d41793ba2696a3a8420e";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script>
</head>
<body>
<div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div><nav class="sticky inset-x-0 top-0 z-50 nav" data-v-cd144d6c><div class="container flex mx-auto z-50 justify-between items-center h-full" data-v-cd144d6c><a href="/" class="text-white text-xl font-normal no-underline nuxt-link-active" data-v-cd144d6c>田写</a> <div class="ml-auto mr-2 search-bar" data-v-cd144d6c><input placeholder="搜索文章" class="search-input" data-v-cd144d6c> <div class="search-result" style="display:none" data-v-cd144d6c></div></div> <div class="hidden md:flex" data-v-cd144d6c><a href="https://github.com/tianyong90" target="_blank" class="text-white ml-4 font-light no-underline" data-v-cd144d6c>GitHub</a> <a href="https://weibo.com/1707227001" target="_blank" class="text-white ml-4 font-light no-underline" data-v-cd144d6c>微博</a></div> <span class="md:hidden mdi text-white text-lg dropdown-menu-toggle mdi-menu" data-v-cd144d6c></span> <div class="container flex md:hidden dropdown-menu" style="display:none" data-v-cd144d6c><a href="/open-source" class="dropdown-menu-item" data-v-cd144d6c>
        开源
      </a> <a href="https://github.com/tianyong90" target="_blank" class="dropdown-menu-item" data-v-cd144d6c>GitHub</a> <a href="https://weibo.com/1707227001" target="_blank" class="dropdown-menu-item" data-v-cd144d6c>微博</a></div></div></nav> <div class="container mt-4 md:my-4" data-v-ce4bf1dc><div class="post rounded-lg overflow-hidden bg-white" data-v-ce4bf1dc><img src="https://raw.githubusercontent.com/tianyong90/blog/gh-pages/_nuxt/posts/Laravel-%E4%B8%AD%E4%BD%BF%E7%94%A8-puppeteer-%E9%87%87%E9%9B%86%E5%BC%82%E6%AD%A5%E5%8A%A0%E8%BD%BD%E7%9A%84%E7%BD%91%E9%A1%B5%E5%86%85%E5%AE%B9//top_img.png" loading="lazy" class="w-full cover-image" data-v-ce4bf1dc> <div class="px-4 md:px-8 py-2" data-v-ce4bf1dc><div class="mb-4" data-v-ce4bf1dc><h1 class="text-gray-800 text-xl font-normal" data-v-ce4bf1dc>Laravel 中使用 puppeteer 采集异步加载的网页内容</h1> <div class="text-gray-700 text-xs post-date" data-v-ce4bf1dc>2019-03-10</div></div> <div class="markdown-body" data-v-ce4bf1dc><p><img src="https://raw.githubusercontent.com/tianyong90/blog/gh-pages/_nuxt/posts/Laravel-%E4%B8%AD%E4%BD%BF%E7%94%A8-puppeteer-%E9%87%87%E9%9B%86%E5%BC%82%E6%AD%A5%E5%8A%A0%E8%BD%BD%E7%9A%84%E7%BD%91%E9%A1%B5%E5%86%85%E5%AE%B9/install_puppeteer.jpg" alt="install puppeteer"></p>
<p>采集网页内容是一项很常见的需求，比较传统的静态页面，curl 就能搞定。但如果页面中有动态加载的内容，比如有些页面里通过 ajax 加载的文章正文内容，又如果有些页面加载完成后进行了一些额外处理（图片地址替换等等……）而你想采集这些处理过后的内容。那么牛逼闪闪的 curl 也束手无策了。</p>
<p>做过类似需求的人可能会说，老铁，上 PhantomJS 啊！</p>
<p>没错，这是一个办法，而且在相当长的时间里 PhantomJS 是为数不多的能解决这类需求的工具里的佼佼者。</p>
<p>但今天这里要介绍的是一个后来居上的工具 -- puppeteer，它是随着 Chrome Headless 技术兴起而快速发展起来的。而且非常关键的是，puppeteer 由 Chrome 的官方团队开发和维护，可以说相当靠谱了！</p>
<p>puppeteer 是一个 js 包，要想在 Laravel 中使用，得借助于另一神器<code>spatie/browsershot</code>。</p>
<h2 id="安装"><a class="header-anchor" href="#安装">#</a> 安装</h2>
<ol>
<li>
<p>安装 <a href="https://github.com/spatie/browsershot">spatie/browsershot</a></p>
<p>browsershot 是一个 composer 包，出自于大神团队 <a href="https://github.com/spatie">spatie</a></p>
<!--beforebegin--><div class="language-bash extra-class"><!--afterbegin--><pre v-pre class="language-bash"><code>$ composer require spatie/browsershot
</code></pre>
<!--beforeend--></div><!--afterend--></li>
<li>
<p>安装 <a href="https://github.com/GoogleChrome/puppeteer">puppeteer</a></p>
<!--beforebegin--><div class="language-shell extra-class"><!--afterbegin--><pre v-pre class="language-shell"><code>$ <span class="token function">npm</span> i puppeteer --save
</code></pre>
<!--beforeend--></div><!--afterend--><blockquote>
<p><strong>也可以全局安全 puppeteer 但就个人经验而言，在项目中安装是比较推荐的做法，因为这样不同项目不会同时受全局安装的 puppeteer 影响，此外项目中安装也方便使用 phpdeployer 进行升级（phpdeploy 升级时不会影响线上项目运行，要知道升级/安装 puppeteer 可是很费时的，有时候还不能保证一次成功）。</strong>
安装 puppeteer 时会下载 Chromium-Browser，鉴于咱特殊国情，很有可能出现无法下载的情况，对此，就请大家各显神通吧……</p>
</blockquote>
</li>
</ol>
<h2 id="使用"><a class="header-anchor" href="#使用">#</a> 使用</h2>
<p>以采集今日头条手机版页面文章内容为例。</p>
<!--beforebegin--><div class="language-php extra-class"><!--afterbegin--><pre v-pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">Spatie<span class="token punctuation">\</span>Browsershot<span class="token punctuation">\</span>Browsershot</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">getBodyHtml</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$newsUrl</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'https://m.toutiao.com/i6546884151050502660/'</span><span class="token punctuation">;</span>

    <span class="token variable">$html</span> <span class="token operator">=</span> Browsershot<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">url</span><span class="token punctuation">(</span><span class="token variable">$newsUrl</span><span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">></span><span class="token function">windowSize</span><span class="token punctuation">(</span><span class="token number">480</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">></span><span class="token function">userAgent</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Mobile Safari/537.36'</span><span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">></span><span class="token function">mobile</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">></span><span class="token function">touch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">></span><span class="token function">bodyHtml</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    \<span class="token package">Log</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token variable">$html</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<!--beforeend--></div><!--afterend--><p>运行后可以在日志中看到如下内容（截图中只是其中部分）</p>
<p><img src="https://raw.githubusercontent.com/tianyong90/blog/gh-pages/_nuxt/posts/Laravel-%E4%B8%AD%E4%BD%BF%E7%94%A8-puppeteer-%E9%87%87%E9%9B%86%E5%BC%82%E6%AD%A5%E5%8A%A0%E8%BD%BD%E7%9A%84%E7%BD%91%E9%A1%B5%E5%86%85%E5%AE%B9/toutiao_log.jpg" alt="日志"></p>
<p>此外，也可以将页面保存为图片或 PDF 文件。</p>
<!--beforebegin--><div class="language-php extra-class"><!--afterbegin--><pre v-pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">Spatie<span class="token punctuation">\</span>Browsershot<span class="token punctuation">\</span>Browsershot</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">getBodyHtml</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$newsUrl</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'https://m.toutiao.com/i6546884151050502660/'</span><span class="token punctuation">;</span>

    Browsershot<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">url</span><span class="token punctuation">(</span><span class="token variable">$newsUrl</span><span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">></span><span class="token function">windowSize</span><span class="token punctuation">(</span><span class="token number">480</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">></span><span class="token function">userAgent</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Mobile Safari/537.36'</span><span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">></span><span class="token function">mobile</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">></span><span class="token function">touch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">></span><span class="token function">setDelay</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">></span><span class="token function">save</span><span class="token punctuation">(</span><span class="token function">public_path</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'images/toutiao.jpg'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<!--beforeend--></div><!--afterend--><p><img src="https://raw.githubusercontent.com/tianyong90/blog/gh-pages/_nuxt/posts/Laravel-%E4%B8%AD%E4%BD%BF%E7%94%A8-puppeteer-%E9%87%87%E9%9B%86%E5%BC%82%E6%AD%A5%E5%8A%A0%E8%BD%BD%E7%9A%84%E7%BD%91%E9%A1%B5%E5%86%85%E5%AE%B9/toutiao.jpg" alt="结果"></p>
<p>图片里那些框与系统字体有关。代码中使用了一个 setDelay() 方法，是为了让内容加载完成后再进行截图，简单粗暴，可能不是最好的解决办法。</p>
<h2 id="可能出现的问题"><a class="header-anchor" href="#可能出现的问题">#</a> 可能出现的问题</h2>
<ul>
<li>
<p>系统得支持 Chromium 浏览器，当然现在绝大部分浏览器是支持的，要不然也没法，还是用 PhantomJS 吧。</p>
</li>
<li>
<p>项目中安装了 puppeteer 后调用时有可能出现权限问题，这就需要对项目下 /node_modules/puppeteer 目录赋予适当的权限。</p>
</li>
</ul>
<h2 id="总结"><a class="header-anchor" href="#总结">#</a> 总结</h2>
<p>puppeteer 被应用于测试、采集等场景，是一个非常有力的工具。对于轻度的采集任务，是够用的，比如本文这类在 Laravel (php) 里来用采集一些小页面，但如果需要快速采集大量内容，还是 Python 啥的吧。😄</p>
</div> <div class="social-share" data-v-ce4bf1dc></div></div></div> <div class="px-4 md:px-0 navigator" data-v-ce4bf1dc><a href="/posts/zi-ji-lu-ge-vue-markdown-loader" class="navigator-btn mr-auto btn-prev" data-v-ce4bf1dc><span class="mdi mdi-chevron-left" data-v-ce4bf1dc></span> 上一篇
    </a> <a href="/posts/ye-lai-che-che-vue-dan-yuan-ce-shi" class="navigator-btn ml-auto btn-next" data-v-ce4bf1dc>下一篇<span class="mdi mdi-chevron-right" data-v-ce4bf1dc></span></a></div></div> <footer class="pt-6 pb-4 footer"><div class="container mx-auto"><p class="text-gray-100 text-center">@2019-2020 ♥ tianyong90</p> <p class="text-gray-100 text-center text-sm">
      共 0 篇文章 最后更新于 
    </p></div></footer> <div class="btn-back-to-top" style="display:none" data-v-42b8f6b3><i class="mdi mdi-arrow-collapse-up" data-v-42b8f6b3></i></div></div></div></div><script>window.__NUXT__={layout:"default",data:[{title:"Laravel 中使用 puppeteer 采集异步加载的网页内容",date:"2019-03-10T16:44:31.000Z",top_img:"./top_img.png",tags:["laravel","puppeteer","采集"],categories:["php","Laravel"],topImg:"https://raw.githubusercontent.com/tianyong90/blog/gh-pages/_nuxt/posts/Laravel-%E4%B8%AD%E4%BD%BF%E7%94%A8-puppeteer-%E9%87%87%E9%9B%86%E5%BC%82%E6%AD%A5%E5%8A%A0%E8%BD%BD%E7%9A%84%E7%BD%91%E9%A1%B5%E5%86%85%E5%AE%B9//top_img.png",html:'<p><img src="https://raw.githubusercontent.com/tianyong90/blog/gh-pages/_nuxt/posts/Laravel-%E4%B8%AD%E4%BD%BF%E7%94%A8-puppeteer-%E9%87%87%E9%9B%86%E5%BC%82%E6%AD%A5%E5%8A%A0%E8%BD%BD%E7%9A%84%E7%BD%91%E9%A1%B5%E5%86%85%E5%AE%B9/install_puppeteer.jpg" alt="install puppeteer"></p>\n<p>采集网页内容是一项很常见的需求，比较传统的静态页面，curl 就能搞定。但如果页面中有动态加载的内容，比如有些页面里通过 ajax 加载的文章正文内容，又如果有些页面加载完成后进行了一些额外处理（图片地址替换等等……）而你想采集这些处理过后的内容。那么牛逼闪闪的 curl 也束手无策了。</p>\n<p>做过类似需求的人可能会说，老铁，上 PhantomJS 啊！</p>\n<p>没错，这是一个办法，而且在相当长的时间里 PhantomJS 是为数不多的能解决这类需求的工具里的佼佼者。</p>\n<p>但今天这里要介绍的是一个后来居上的工具 -- puppeteer，它是随着 Chrome Headless 技术兴起而快速发展起来的。而且非常关键的是，puppeteer 由 Chrome 的官方团队开发和维护，可以说相当靠谱了！</p>\n<p>puppeteer 是一个 js 包，要想在 Laravel 中使用，得借助于另一神器<code>spatie/browsershot</code>。</p>\n<h2 id="安装"><a class="header-anchor" href="#安装">#</a> 安装</h2>\n<ol>\n<li>\n<p>安装 <a href="https://github.com/spatie/browsershot">spatie/browsershot</a></p>\n<p>browsershot 是一个 composer 包，出自于大神团队 <a href="https://github.com/spatie">spatie</a></p>\n\x3c!--beforebegin--\x3e<div class="language-bash extra-class">\x3c!--afterbegin--\x3e<pre v-pre class="language-bash"><code>$ composer require spatie/browsershot\n</code></pre>\n\x3c!--beforeend--\x3e</div>\x3c!--afterend--\x3e</li>\n<li>\n<p>安装 <a href="https://github.com/GoogleChrome/puppeteer">puppeteer</a></p>\n\x3c!--beforebegin--\x3e<div class="language-shell extra-class">\x3c!--afterbegin--\x3e<pre v-pre class="language-shell"><code>$ <span class="token function">npm</span> i puppeteer --save\n</code></pre>\n\x3c!--beforeend--\x3e</div>\x3c!--afterend--\x3e<blockquote>\n<p><strong>也可以全局安全 puppeteer 但就个人经验而言，在项目中安装是比较推荐的做法，因为这样不同项目不会同时受全局安装的 puppeteer 影响，此外项目中安装也方便使用 phpdeployer 进行升级（phpdeploy 升级时不会影响线上项目运行，要知道升级/安装 puppeteer 可是很费时的，有时候还不能保证一次成功）。</strong>\n安装 puppeteer 时会下载 Chromium-Browser，鉴于咱特殊国情，很有可能出现无法下载的情况，对此，就请大家各显神通吧……</p>\n</blockquote>\n</li>\n</ol>\n<h2 id="使用"><a class="header-anchor" href="#使用">#</a> 使用</h2>\n<p>以采集今日头条手机版页面文章内容为例。</p>\n\x3c!--beforebegin--\x3e<div class="language-php extra-class">\x3c!--afterbegin--\x3e<pre v-pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">Spatie<span class="token punctuation">\\</span>Browsershot<span class="token punctuation">\\</span>Browsershot</span><span class="token punctuation">;</span>\n\n<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">getBodyHtml</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    <span class="token variable">$newsUrl</span> <span class="token operator">=</span> <span class="token single-quoted-string string">\'https://m.toutiao.com/i6546884151050502660/\'</span><span class="token punctuation">;</span>\n\n    <span class="token variable">$html</span> <span class="token operator">=</span> Browsershot<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">url</span><span class="token punctuation">(</span><span class="token variable">$newsUrl</span><span class="token punctuation">)</span>\n        <span class="token operator">-</span><span class="token operator">></span><span class="token function">windowSize</span><span class="token punctuation">(</span><span class="token number">480</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span>\n        <span class="token operator">-</span><span class="token operator">></span><span class="token function">userAgent</span><span class="token punctuation">(</span><span class="token single-quoted-string string">\'Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Mobile Safari/537.36\'</span><span class="token punctuation">)</span>\n        <span class="token operator">-</span><span class="token operator">></span><span class="token function">mobile</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n        <span class="token operator">-</span><span class="token operator">></span><span class="token function">touch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n        <span class="token operator">-</span><span class="token operator">></span><span class="token function">bodyHtml</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    \\<span class="token package">Log</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token variable">$html</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n\x3c!--beforeend--\x3e</div>\x3c!--afterend--\x3e<p>运行后可以在日志中看到如下内容（截图中只是其中部分）</p>\n<p><img src="https://raw.githubusercontent.com/tianyong90/blog/gh-pages/_nuxt/posts/Laravel-%E4%B8%AD%E4%BD%BF%E7%94%A8-puppeteer-%E9%87%87%E9%9B%86%E5%BC%82%E6%AD%A5%E5%8A%A0%E8%BD%BD%E7%9A%84%E7%BD%91%E9%A1%B5%E5%86%85%E5%AE%B9/toutiao_log.jpg" alt="日志"></p>\n<p>此外，也可以将页面保存为图片或 PDF 文件。</p>\n\x3c!--beforebegin--\x3e<div class="language-php extra-class">\x3c!--afterbegin--\x3e<pre v-pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">Spatie<span class="token punctuation">\\</span>Browsershot<span class="token punctuation">\\</span>Browsershot</span><span class="token punctuation">;</span>\n\n<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">getBodyHtml</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    <span class="token variable">$newsUrl</span> <span class="token operator">=</span> <span class="token single-quoted-string string">\'https://m.toutiao.com/i6546884151050502660/\'</span><span class="token punctuation">;</span>\n\n    Browsershot<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">url</span><span class="token punctuation">(</span><span class="token variable">$newsUrl</span><span class="token punctuation">)</span>\n        <span class="token operator">-</span><span class="token operator">></span><span class="token function">windowSize</span><span class="token punctuation">(</span><span class="token number">480</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span>\n        <span class="token operator">-</span><span class="token operator">></span><span class="token function">userAgent</span><span class="token punctuation">(</span><span class="token single-quoted-string string">\'Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Mobile Safari/537.36\'</span><span class="token punctuation">)</span>\n        <span class="token operator">-</span><span class="token operator">></span><span class="token function">mobile</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n        <span class="token operator">-</span><span class="token operator">></span><span class="token function">touch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n        <span class="token operator">-</span><span class="token operator">></span><span class="token function">setDelay</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>\n        <span class="token operator">-</span><span class="token operator">></span><span class="token function">save</span><span class="token punctuation">(</span><span class="token function">public_path</span><span class="token punctuation">(</span><span class="token single-quoted-string string">\'images/toutiao.jpg\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n\x3c!--beforeend--\x3e</div>\x3c!--afterend--\x3e<p><img src="https://raw.githubusercontent.com/tianyong90/blog/gh-pages/_nuxt/posts/Laravel-%E4%B8%AD%E4%BD%BF%E7%94%A8-puppeteer-%E9%87%87%E9%9B%86%E5%BC%82%E6%AD%A5%E5%8A%A0%E8%BD%BD%E7%9A%84%E7%BD%91%E9%A1%B5%E5%86%85%E5%AE%B9/toutiao.jpg" alt="结果"></p>\n<p>图片里那些框与系统字体有关。代码中使用了一个 setDelay() 方法，是为了让内容加载完成后再进行截图，简单粗暴，可能不是最好的解决办法。</p>\n<h2 id="可能出现的问题"><a class="header-anchor" href="#可能出现的问题">#</a> 可能出现的问题</h2>\n<ul>\n<li>\n<p>系统得支持 Chromium 浏览器，当然现在绝大部分浏览器是支持的，要不然也没法，还是用 PhantomJS 吧。</p>\n</li>\n<li>\n<p>项目中安装了 puppeteer 后调用时有可能出现权限问题，这就需要对项目下 /node_modules/puppeteer 目录赋予适当的权限。</p>\n</li>\n</ul>\n<h2 id="总结"><a class="header-anchor" href="#总结">#</a> 总结</h2>\n<p>puppeteer 被应用于测试、采集等场景，是一个非常有力的工具。对于轻度的采集任务，是够用的，比如本文这类在 Laravel (php) 里来用采集一些小页面，但如果需要快速采集大量内容，还是 Python 啥的吧。😄</p>\n',prevLink:"/posts/zi-ji-lu-ge-vue-markdown-loader",nextLink:"/posts/ye-lai-che-che-vue-dan-yuan-ce-shi"}],fetch:[],error:null,state:{dropdownMenuVisible:!1,postCount:0,updatedAt:""},serverRendered:!0,routePath:"/posts/laravel-zhong-shi-yong-puppeteer-cai-ji-yi-bu-jia-zai-de-wang-ye-nei-rong"}</script><script src="/_nuxt/01bcce01f8c790f5d374.js" defer></script><script src="/_nuxt/07bd7fabb502977506dc.js" defer></script><script src="/_nuxt/105c752e7a97439a686c.js" defer></script><script src="/_nuxt/21062646b9e158167d36.js" defer></script><script src="/_nuxt/d1fd124a92a019d40dff.js" defer></script>
</body>
</html>
