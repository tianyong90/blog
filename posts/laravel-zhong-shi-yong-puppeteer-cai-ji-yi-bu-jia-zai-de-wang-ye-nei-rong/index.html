<!doctype html>
<html data-n-head-ssr>
<head>
  <title>ç”°å†™</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="description" name="description" content="ç”°å‹‡çš„åšå®¢ã€‚æŠ€æœ¯ã€ç”Ÿæ´»åŠå…¶å®ƒâ€¦â€¦"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="preload" href="/_nuxt/01bcce01f8c790f5d374.js" as="script"><link rel="preload" href="/_nuxt/105c752e7a97439a686c.js" as="script"><link rel="preload" href="/_nuxt/825e626c37db3decba58.css" as="style"><link rel="preload" href="/_nuxt/21062646b9e158167d36.js" as="script"><link rel="preload" href="/_nuxt/0fdbd6daeffcd4f7250c.css" as="style"><link rel="preload" href="/_nuxt/d1fd124a92a019d40dff.js" as="script"><link rel="preload" href="/_nuxt/3e147d9494bb78de7c6e.css" as="style"><link rel="preload" href="/_nuxt/07bd7fabb502977506dc.js" as="script"><link rel="stylesheet" href="/_nuxt/825e626c37db3decba58.css"><link rel="stylesheet" href="/_nuxt/0fdbd6daeffcd4f7250c.css"><link rel="stylesheet" href="/_nuxt/3e147d9494bb78de7c6e.css">
  <script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?0f605ed20935d41793ba2696a3a8420e";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script>
</head>
<body>
<div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div><nav class="sticky inset-x-0 top-0 z-50 nav" data-v-cd144d6c><div class="container flex mx-auto z-50 justify-between items-center h-full" data-v-cd144d6c><a href="/" class="text-white text-xl font-normal no-underline nuxt-link-active" data-v-cd144d6c>ç”°å†™</a> <div class="ml-auto mr-2 search-bar" data-v-cd144d6c><input placeholder="æœç´¢æ–‡ç« " class="search-input" data-v-cd144d6c> <div class="search-result" style="display:none" data-v-cd144d6c></div></div> <div class="hidden md:flex" data-v-cd144d6c><a href="https://github.com/tianyong90" target="_blank" class="text-white ml-4 font-light no-underline" data-v-cd144d6c>GitHub</a> <a href="https://weibo.com/1707227001" target="_blank" class="text-white ml-4 font-light no-underline" data-v-cd144d6c>å¾®åš</a></div> <span class="md:hidden mdi text-white text-lg dropdown-menu-toggle mdi-menu" data-v-cd144d6c></span> <div class="container flex md:hidden dropdown-menu" style="display:none" data-v-cd144d6c><a href="/open-source" class="dropdown-menu-item" data-v-cd144d6c>
        å¼€æº
      </a> <a href="https://github.com/tianyong90" target="_blank" class="dropdown-menu-item" data-v-cd144d6c>GitHub</a> <a href="https://weibo.com/1707227001" target="_blank" class="dropdown-menu-item" data-v-cd144d6c>å¾®åš</a></div></div></nav> <div class="container mt-4 md:my-4" data-v-ce4bf1dc><div class="post rounded-lg overflow-hidden bg-white" data-v-ce4bf1dc><img src="https://raw.githubusercontent.com/tianyong90/blog/gh-pages/_nuxt/posts/Laravel-%E4%B8%AD%E4%BD%BF%E7%94%A8-puppeteer-%E9%87%87%E9%9B%86%E5%BC%82%E6%AD%A5%E5%8A%A0%E8%BD%BD%E7%9A%84%E7%BD%91%E9%A1%B5%E5%86%85%E5%AE%B9//top_img.png" loading="lazy" class="w-full cover-image" data-v-ce4bf1dc> <div class="px-4 md:px-8 py-2" data-v-ce4bf1dc><div class="mb-4" data-v-ce4bf1dc><h1 class="text-gray-800 text-xl font-normal" data-v-ce4bf1dc>Laravel ä¸­ä½¿ç”¨ puppeteer é‡‡é›†å¼‚æ­¥åŠ è½½çš„ç½‘é¡µå†…å®¹</h1> <div class="text-gray-700 text-xs post-date" data-v-ce4bf1dc>2019-03-10</div></div> <div class="markdown-body" data-v-ce4bf1dc><p><img src="https://raw.githubusercontent.com/tianyong90/blog/gh-pages/_nuxt/posts/Laravel-%E4%B8%AD%E4%BD%BF%E7%94%A8-puppeteer-%E9%87%87%E9%9B%86%E5%BC%82%E6%AD%A5%E5%8A%A0%E8%BD%BD%E7%9A%84%E7%BD%91%E9%A1%B5%E5%86%85%E5%AE%B9/install_puppeteer.jpg" alt="install puppeteer"></p>
<p>é‡‡é›†ç½‘é¡µå†…å®¹æ˜¯ä¸€é¡¹å¾ˆå¸¸è§çš„éœ€æ±‚ï¼Œæ¯”è¾ƒä¼ ç»Ÿçš„é™æ€é¡µé¢ï¼Œcurl å°±èƒ½æå®šã€‚ä½†å¦‚æœé¡µé¢ä¸­æœ‰åŠ¨æ€åŠ è½½çš„å†…å®¹ï¼Œæ¯”å¦‚æœ‰äº›é¡µé¢é‡Œé€šè¿‡ ajax åŠ è½½çš„æ–‡ç« æ­£æ–‡å†…å®¹ï¼Œåˆå¦‚æœæœ‰äº›é¡µé¢åŠ è½½å®Œæˆåè¿›è¡Œäº†ä¸€äº›é¢å¤–å¤„ç†ï¼ˆå›¾ç‰‡åœ°å€æ›¿æ¢ç­‰ç­‰â€¦â€¦ï¼‰è€Œä½ æƒ³é‡‡é›†è¿™äº›å¤„ç†è¿‡åçš„å†…å®¹ã€‚é‚£ä¹ˆç‰›é€¼é—ªé—ªçš„ curl ä¹ŸæŸæ‰‹æ— ç­–äº†ã€‚</p>
<p>åšè¿‡ç±»ä¼¼éœ€æ±‚çš„äººå¯èƒ½ä¼šè¯´ï¼Œè€é“ï¼Œä¸Š PhantomJS å•Šï¼</p>
<p>æ²¡é”™ï¼Œè¿™æ˜¯ä¸€ä¸ªåŠæ³•ï¼Œè€Œä¸”åœ¨ç›¸å½“é•¿çš„æ—¶é—´é‡Œ PhantomJS æ˜¯ä¸ºæ•°ä¸å¤šçš„èƒ½è§£å†³è¿™ç±»éœ€æ±‚çš„å·¥å…·é‡Œçš„ä½¼ä½¼è€…ã€‚</p>
<p>ä½†ä»Šå¤©è¿™é‡Œè¦ä»‹ç»çš„æ˜¯ä¸€ä¸ªåæ¥å±…ä¸Šçš„å·¥å…· -- puppeteerï¼Œå®ƒæ˜¯éšç€ Chrome Headless æŠ€æœ¯å…´èµ·è€Œå¿«é€Ÿå‘å±•èµ·æ¥çš„ã€‚è€Œä¸”éå¸¸å…³é”®çš„æ˜¯ï¼Œpuppeteer ç”± Chrome çš„å®˜æ–¹å›¢é˜Ÿå¼€å‘å’Œç»´æŠ¤ï¼Œå¯ä»¥è¯´ç›¸å½“é è°±äº†ï¼</p>
<p>puppeteer æ˜¯ä¸€ä¸ª js åŒ…ï¼Œè¦æƒ³åœ¨ Laravel ä¸­ä½¿ç”¨ï¼Œå¾—å€ŸåŠ©äºå¦ä¸€ç¥å™¨<code>spatie/browsershot</code>ã€‚</p>
<h2 id="å®‰è£…"><a class="header-anchor" href="#å®‰è£…">#</a> å®‰è£…</h2>
<ol>
<li>
<p>å®‰è£… <a href="https://github.com/spatie/browsershot">spatie/browsershot</a></p>
<p>browsershot æ˜¯ä¸€ä¸ª composer åŒ…ï¼Œå‡ºè‡ªäºå¤§ç¥å›¢é˜Ÿ <a href="https://github.com/spatie">spatie</a></p>
<!--beforebegin--><div class="language-bash extra-class"><!--afterbegin--><pre v-pre class="language-bash"><code>$ composer require spatie/browsershot
</code></pre>
<!--beforeend--></div><!--afterend--></li>
<li>
<p>å®‰è£… <a href="https://github.com/GoogleChrome/puppeteer">puppeteer</a></p>
<!--beforebegin--><div class="language-shell extra-class"><!--afterbegin--><pre v-pre class="language-shell"><code>$ <span class="token function">npm</span> i puppeteer --save
</code></pre>
<!--beforeend--></div><!--afterend--><blockquote>
<p><strong>ä¹Ÿå¯ä»¥å…¨å±€å®‰å…¨ puppeteer ä½†å°±ä¸ªäººç»éªŒè€Œè¨€ï¼Œåœ¨é¡¹ç›®ä¸­å®‰è£…æ˜¯æ¯”è¾ƒæ¨èçš„åšæ³•ï¼Œå› ä¸ºè¿™æ ·ä¸åŒé¡¹ç›®ä¸ä¼šåŒæ—¶å—å…¨å±€å®‰è£…çš„ puppeteer å½±å“ï¼Œæ­¤å¤–é¡¹ç›®ä¸­å®‰è£…ä¹Ÿæ–¹ä¾¿ä½¿ç”¨ phpdeployer è¿›è¡Œå‡çº§ï¼ˆphpdeploy å‡çº§æ—¶ä¸ä¼šå½±å“çº¿ä¸Šé¡¹ç›®è¿è¡Œï¼Œè¦çŸ¥é“å‡çº§/å®‰è£… puppeteer å¯æ˜¯å¾ˆè´¹æ—¶çš„ï¼Œæœ‰æ—¶å€™è¿˜ä¸èƒ½ä¿è¯ä¸€æ¬¡æˆåŠŸï¼‰ã€‚</strong>
å®‰è£… puppeteer æ—¶ä¼šä¸‹è½½ Chromium-Browserï¼Œé‰´äºå’±ç‰¹æ®Šå›½æƒ…ï¼Œå¾ˆæœ‰å¯èƒ½å‡ºç°æ— æ³•ä¸‹è½½çš„æƒ…å†µï¼Œå¯¹æ­¤ï¼Œå°±è¯·å¤§å®¶å„æ˜¾ç¥é€šå§â€¦â€¦</p>
</blockquote>
</li>
</ol>
<h2 id="ä½¿ç”¨"><a class="header-anchor" href="#ä½¿ç”¨">#</a> ä½¿ç”¨</h2>
<p>ä»¥é‡‡é›†ä»Šæ—¥å¤´æ¡æ‰‹æœºç‰ˆé¡µé¢æ–‡ç« å†…å®¹ä¸ºä¾‹ã€‚</p>
<!--beforebegin--><div class="language-php extra-class"><!--afterbegin--><pre v-pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">Spatie<span class="token punctuation">\</span>Browsershot<span class="token punctuation">\</span>Browsershot</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">getBodyHtml</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$newsUrl</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'https://m.toutiao.com/i6546884151050502660/'</span><span class="token punctuation">;</span>

    <span class="token variable">$html</span> <span class="token operator">=</span> Browsershot<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">url</span><span class="token punctuation">(</span><span class="token variable">$newsUrl</span><span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">></span><span class="token function">windowSize</span><span class="token punctuation">(</span><span class="token number">480</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">></span><span class="token function">userAgent</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Mobile Safari/537.36'</span><span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">></span><span class="token function">mobile</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">></span><span class="token function">touch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">></span><span class="token function">bodyHtml</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    \<span class="token package">Log</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token variable">$html</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<!--beforeend--></div><!--afterend--><p>è¿è¡Œåå¯ä»¥åœ¨æ—¥å¿—ä¸­çœ‹åˆ°å¦‚ä¸‹å†…å®¹ï¼ˆæˆªå›¾ä¸­åªæ˜¯å…¶ä¸­éƒ¨åˆ†ï¼‰</p>
<p><img src="https://raw.githubusercontent.com/tianyong90/blog/gh-pages/_nuxt/posts/Laravel-%E4%B8%AD%E4%BD%BF%E7%94%A8-puppeteer-%E9%87%87%E9%9B%86%E5%BC%82%E6%AD%A5%E5%8A%A0%E8%BD%BD%E7%9A%84%E7%BD%91%E9%A1%B5%E5%86%85%E5%AE%B9/toutiao_log.jpg" alt="æ—¥å¿—"></p>
<p>æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥å°†é¡µé¢ä¿å­˜ä¸ºå›¾ç‰‡æˆ– PDF æ–‡ä»¶ã€‚</p>
<!--beforebegin--><div class="language-php extra-class"><!--afterbegin--><pre v-pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">Spatie<span class="token punctuation">\</span>Browsershot<span class="token punctuation">\</span>Browsershot</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">getBodyHtml</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$newsUrl</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'https://m.toutiao.com/i6546884151050502660/'</span><span class="token punctuation">;</span>

    Browsershot<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">url</span><span class="token punctuation">(</span><span class="token variable">$newsUrl</span><span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">></span><span class="token function">windowSize</span><span class="token punctuation">(</span><span class="token number">480</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">></span><span class="token function">userAgent</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Mobile Safari/537.36'</span><span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">></span><span class="token function">mobile</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">></span><span class="token function">touch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">></span><span class="token function">setDelay</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">></span><span class="token function">save</span><span class="token punctuation">(</span><span class="token function">public_path</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'images/toutiao.jpg'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<!--beforeend--></div><!--afterend--><p><img src="https://raw.githubusercontent.com/tianyong90/blog/gh-pages/_nuxt/posts/Laravel-%E4%B8%AD%E4%BD%BF%E7%94%A8-puppeteer-%E9%87%87%E9%9B%86%E5%BC%82%E6%AD%A5%E5%8A%A0%E8%BD%BD%E7%9A%84%E7%BD%91%E9%A1%B5%E5%86%85%E5%AE%B9/toutiao.jpg" alt="ç»“æœ"></p>
<p>å›¾ç‰‡é‡Œé‚£äº›æ¡†ä¸ç³»ç»Ÿå­—ä½“æœ‰å…³ã€‚ä»£ç ä¸­ä½¿ç”¨äº†ä¸€ä¸ª setDelay() æ–¹æ³•ï¼Œæ˜¯ä¸ºäº†è®©å†…å®¹åŠ è½½å®Œæˆåå†è¿›è¡Œæˆªå›¾ï¼Œç®€å•ç²—æš´ï¼Œå¯èƒ½ä¸æ˜¯æœ€å¥½çš„è§£å†³åŠæ³•ã€‚</p>
<h2 id="å¯èƒ½å‡ºç°çš„é—®é¢˜"><a class="header-anchor" href="#å¯èƒ½å‡ºç°çš„é—®é¢˜">#</a> å¯èƒ½å‡ºç°çš„é—®é¢˜</h2>
<ul>
<li>
<p>ç³»ç»Ÿå¾—æ”¯æŒ Chromium æµè§ˆå™¨ï¼Œå½“ç„¶ç°åœ¨ç»å¤§éƒ¨åˆ†æµè§ˆå™¨æ˜¯æ”¯æŒçš„ï¼Œè¦ä¸ç„¶ä¹Ÿæ²¡æ³•ï¼Œè¿˜æ˜¯ç”¨ PhantomJS å§ã€‚</p>
</li>
<li>
<p>é¡¹ç›®ä¸­å®‰è£…äº† puppeteer åè°ƒç”¨æ—¶æœ‰å¯èƒ½å‡ºç°æƒé™é—®é¢˜ï¼Œè¿™å°±éœ€è¦å¯¹é¡¹ç›®ä¸‹ /node_modules/puppeteer ç›®å½•èµ‹äºˆé€‚å½“çš„æƒé™ã€‚</p>
</li>
</ul>
<h2 id="æ€»ç»“"><a class="header-anchor" href="#æ€»ç»“">#</a> æ€»ç»“</h2>
<p>puppeteer è¢«åº”ç”¨äºæµ‹è¯•ã€é‡‡é›†ç­‰åœºæ™¯ï¼Œæ˜¯ä¸€ä¸ªéå¸¸æœ‰åŠ›çš„å·¥å…·ã€‚å¯¹äºè½»åº¦çš„é‡‡é›†ä»»åŠ¡ï¼Œæ˜¯å¤Ÿç”¨çš„ï¼Œæ¯”å¦‚æœ¬æ–‡è¿™ç±»åœ¨ Laravel (php) é‡Œæ¥ç”¨é‡‡é›†ä¸€äº›å°é¡µé¢ï¼Œä½†å¦‚æœéœ€è¦å¿«é€Ÿé‡‡é›†å¤§é‡å†…å®¹ï¼Œè¿˜æ˜¯ Python å•¥çš„å§ã€‚ğŸ˜„</p>
</div> <div class="social-share" data-v-ce4bf1dc></div></div></div> <div class="px-4 md:px-0 navigator" data-v-ce4bf1dc><a href="/posts/zi-ji-lu-ge-vue-markdown-loader" class="navigator-btn mr-auto btn-prev" data-v-ce4bf1dc><span class="mdi mdi-chevron-left" data-v-ce4bf1dc></span> ä¸Šä¸€ç¯‡
    </a> <a href="/posts/ye-lai-che-che-vue-dan-yuan-ce-shi" class="navigator-btn ml-auto btn-next" data-v-ce4bf1dc>ä¸‹ä¸€ç¯‡<span class="mdi mdi-chevron-right" data-v-ce4bf1dc></span></a></div></div> <footer class="pt-6 pb-4 footer"><div class="container mx-auto"><p class="text-gray-100 text-center">@2019-2020 â™¥ tianyong90</p> <p class="text-gray-100 text-center text-sm">
      å…± 0 ç¯‡æ–‡ç«  æœ€åæ›´æ–°äº 
    </p></div></footer> <div class="btn-back-to-top" style="display:none" data-v-42b8f6b3><i class="mdi mdi-arrow-collapse-up" data-v-42b8f6b3></i></div></div></div></div><script>window.__NUXT__={layout:"default",data:[{title:"Laravel ä¸­ä½¿ç”¨ puppeteer é‡‡é›†å¼‚æ­¥åŠ è½½çš„ç½‘é¡µå†…å®¹",date:"2019-03-10T16:44:31.000Z",top_img:"./top_img.png",tags:["laravel","puppeteer","é‡‡é›†"],categories:["php","Laravel"],topImg:"https://raw.githubusercontent.com/tianyong90/blog/gh-pages/_nuxt/posts/Laravel-%E4%B8%AD%E4%BD%BF%E7%94%A8-puppeteer-%E9%87%87%E9%9B%86%E5%BC%82%E6%AD%A5%E5%8A%A0%E8%BD%BD%E7%9A%84%E7%BD%91%E9%A1%B5%E5%86%85%E5%AE%B9//top_img.png",html:'<p><img src="https://raw.githubusercontent.com/tianyong90/blog/gh-pages/_nuxt/posts/Laravel-%E4%B8%AD%E4%BD%BF%E7%94%A8-puppeteer-%E9%87%87%E9%9B%86%E5%BC%82%E6%AD%A5%E5%8A%A0%E8%BD%BD%E7%9A%84%E7%BD%91%E9%A1%B5%E5%86%85%E5%AE%B9/install_puppeteer.jpg" alt="install puppeteer"></p>\n<p>é‡‡é›†ç½‘é¡µå†…å®¹æ˜¯ä¸€é¡¹å¾ˆå¸¸è§çš„éœ€æ±‚ï¼Œæ¯”è¾ƒä¼ ç»Ÿçš„é™æ€é¡µé¢ï¼Œcurl å°±èƒ½æå®šã€‚ä½†å¦‚æœé¡µé¢ä¸­æœ‰åŠ¨æ€åŠ è½½çš„å†…å®¹ï¼Œæ¯”å¦‚æœ‰äº›é¡µé¢é‡Œé€šè¿‡ ajax åŠ è½½çš„æ–‡ç« æ­£æ–‡å†…å®¹ï¼Œåˆå¦‚æœæœ‰äº›é¡µé¢åŠ è½½å®Œæˆåè¿›è¡Œäº†ä¸€äº›é¢å¤–å¤„ç†ï¼ˆå›¾ç‰‡åœ°å€æ›¿æ¢ç­‰ç­‰â€¦â€¦ï¼‰è€Œä½ æƒ³é‡‡é›†è¿™äº›å¤„ç†è¿‡åçš„å†…å®¹ã€‚é‚£ä¹ˆç‰›é€¼é—ªé—ªçš„ curl ä¹ŸæŸæ‰‹æ— ç­–äº†ã€‚</p>\n<p>åšè¿‡ç±»ä¼¼éœ€æ±‚çš„äººå¯èƒ½ä¼šè¯´ï¼Œè€é“ï¼Œä¸Š PhantomJS å•Šï¼</p>\n<p>æ²¡é”™ï¼Œè¿™æ˜¯ä¸€ä¸ªåŠæ³•ï¼Œè€Œä¸”åœ¨ç›¸å½“é•¿çš„æ—¶é—´é‡Œ PhantomJS æ˜¯ä¸ºæ•°ä¸å¤šçš„èƒ½è§£å†³è¿™ç±»éœ€æ±‚çš„å·¥å…·é‡Œçš„ä½¼ä½¼è€…ã€‚</p>\n<p>ä½†ä»Šå¤©è¿™é‡Œè¦ä»‹ç»çš„æ˜¯ä¸€ä¸ªåæ¥å±…ä¸Šçš„å·¥å…· -- puppeteerï¼Œå®ƒæ˜¯éšç€ Chrome Headless æŠ€æœ¯å…´èµ·è€Œå¿«é€Ÿå‘å±•èµ·æ¥çš„ã€‚è€Œä¸”éå¸¸å…³é”®çš„æ˜¯ï¼Œpuppeteer ç”± Chrome çš„å®˜æ–¹å›¢é˜Ÿå¼€å‘å’Œç»´æŠ¤ï¼Œå¯ä»¥è¯´ç›¸å½“é è°±äº†ï¼</p>\n<p>puppeteer æ˜¯ä¸€ä¸ª js åŒ…ï¼Œè¦æƒ³åœ¨ Laravel ä¸­ä½¿ç”¨ï¼Œå¾—å€ŸåŠ©äºå¦ä¸€ç¥å™¨<code>spatie/browsershot</code>ã€‚</p>\n<h2 id="å®‰è£…"><a class="header-anchor" href="#å®‰è£…">#</a> å®‰è£…</h2>\n<ol>\n<li>\n<p>å®‰è£… <a href="https://github.com/spatie/browsershot">spatie/browsershot</a></p>\n<p>browsershot æ˜¯ä¸€ä¸ª composer åŒ…ï¼Œå‡ºè‡ªäºå¤§ç¥å›¢é˜Ÿ <a href="https://github.com/spatie">spatie</a></p>\n\x3c!--beforebegin--\x3e<div class="language-bash extra-class">\x3c!--afterbegin--\x3e<pre v-pre class="language-bash"><code>$ composer require spatie/browsershot\n</code></pre>\n\x3c!--beforeend--\x3e</div>\x3c!--afterend--\x3e</li>\n<li>\n<p>å®‰è£… <a href="https://github.com/GoogleChrome/puppeteer">puppeteer</a></p>\n\x3c!--beforebegin--\x3e<div class="language-shell extra-class">\x3c!--afterbegin--\x3e<pre v-pre class="language-shell"><code>$ <span class="token function">npm</span> i puppeteer --save\n</code></pre>\n\x3c!--beforeend--\x3e</div>\x3c!--afterend--\x3e<blockquote>\n<p><strong>ä¹Ÿå¯ä»¥å…¨å±€å®‰å…¨ puppeteer ä½†å°±ä¸ªäººç»éªŒè€Œè¨€ï¼Œåœ¨é¡¹ç›®ä¸­å®‰è£…æ˜¯æ¯”è¾ƒæ¨èçš„åšæ³•ï¼Œå› ä¸ºè¿™æ ·ä¸åŒé¡¹ç›®ä¸ä¼šåŒæ—¶å—å…¨å±€å®‰è£…çš„ puppeteer å½±å“ï¼Œæ­¤å¤–é¡¹ç›®ä¸­å®‰è£…ä¹Ÿæ–¹ä¾¿ä½¿ç”¨ phpdeployer è¿›è¡Œå‡çº§ï¼ˆphpdeploy å‡çº§æ—¶ä¸ä¼šå½±å“çº¿ä¸Šé¡¹ç›®è¿è¡Œï¼Œè¦çŸ¥é“å‡çº§/å®‰è£… puppeteer å¯æ˜¯å¾ˆè´¹æ—¶çš„ï¼Œæœ‰æ—¶å€™è¿˜ä¸èƒ½ä¿è¯ä¸€æ¬¡æˆåŠŸï¼‰ã€‚</strong>\nå®‰è£… puppeteer æ—¶ä¼šä¸‹è½½ Chromium-Browserï¼Œé‰´äºå’±ç‰¹æ®Šå›½æƒ…ï¼Œå¾ˆæœ‰å¯èƒ½å‡ºç°æ— æ³•ä¸‹è½½çš„æƒ…å†µï¼Œå¯¹æ­¤ï¼Œå°±è¯·å¤§å®¶å„æ˜¾ç¥é€šå§â€¦â€¦</p>\n</blockquote>\n</li>\n</ol>\n<h2 id="ä½¿ç”¨"><a class="header-anchor" href="#ä½¿ç”¨">#</a> ä½¿ç”¨</h2>\n<p>ä»¥é‡‡é›†ä»Šæ—¥å¤´æ¡æ‰‹æœºç‰ˆé¡µé¢æ–‡ç« å†…å®¹ä¸ºä¾‹ã€‚</p>\n\x3c!--beforebegin--\x3e<div class="language-php extra-class">\x3c!--afterbegin--\x3e<pre v-pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">Spatie<span class="token punctuation">\\</span>Browsershot<span class="token punctuation">\\</span>Browsershot</span><span class="token punctuation">;</span>\n\n<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">getBodyHtml</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    <span class="token variable">$newsUrl</span> <span class="token operator">=</span> <span class="token single-quoted-string string">\'https://m.toutiao.com/i6546884151050502660/\'</span><span class="token punctuation">;</span>\n\n    <span class="token variable">$html</span> <span class="token operator">=</span> Browsershot<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">url</span><span class="token punctuation">(</span><span class="token variable">$newsUrl</span><span class="token punctuation">)</span>\n        <span class="token operator">-</span><span class="token operator">></span><span class="token function">windowSize</span><span class="token punctuation">(</span><span class="token number">480</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span>\n        <span class="token operator">-</span><span class="token operator">></span><span class="token function">userAgent</span><span class="token punctuation">(</span><span class="token single-quoted-string string">\'Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Mobile Safari/537.36\'</span><span class="token punctuation">)</span>\n        <span class="token operator">-</span><span class="token operator">></span><span class="token function">mobile</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n        <span class="token operator">-</span><span class="token operator">></span><span class="token function">touch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n        <span class="token operator">-</span><span class="token operator">></span><span class="token function">bodyHtml</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    \\<span class="token package">Log</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token variable">$html</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n\x3c!--beforeend--\x3e</div>\x3c!--afterend--\x3e<p>è¿è¡Œåå¯ä»¥åœ¨æ—¥å¿—ä¸­çœ‹åˆ°å¦‚ä¸‹å†…å®¹ï¼ˆæˆªå›¾ä¸­åªæ˜¯å…¶ä¸­éƒ¨åˆ†ï¼‰</p>\n<p><img src="https://raw.githubusercontent.com/tianyong90/blog/gh-pages/_nuxt/posts/Laravel-%E4%B8%AD%E4%BD%BF%E7%94%A8-puppeteer-%E9%87%87%E9%9B%86%E5%BC%82%E6%AD%A5%E5%8A%A0%E8%BD%BD%E7%9A%84%E7%BD%91%E9%A1%B5%E5%86%85%E5%AE%B9/toutiao_log.jpg" alt="æ—¥å¿—"></p>\n<p>æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥å°†é¡µé¢ä¿å­˜ä¸ºå›¾ç‰‡æˆ– PDF æ–‡ä»¶ã€‚</p>\n\x3c!--beforebegin--\x3e<div class="language-php extra-class">\x3c!--afterbegin--\x3e<pre v-pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">Spatie<span class="token punctuation">\\</span>Browsershot<span class="token punctuation">\\</span>Browsershot</span><span class="token punctuation">;</span>\n\n<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">getBodyHtml</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    <span class="token variable">$newsUrl</span> <span class="token operator">=</span> <span class="token single-quoted-string string">\'https://m.toutiao.com/i6546884151050502660/\'</span><span class="token punctuation">;</span>\n\n    Browsershot<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">url</span><span class="token punctuation">(</span><span class="token variable">$newsUrl</span><span class="token punctuation">)</span>\n        <span class="token operator">-</span><span class="token operator">></span><span class="token function">windowSize</span><span class="token punctuation">(</span><span class="token number">480</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span>\n        <span class="token operator">-</span><span class="token operator">></span><span class="token function">userAgent</span><span class="token punctuation">(</span><span class="token single-quoted-string string">\'Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Mobile Safari/537.36\'</span><span class="token punctuation">)</span>\n        <span class="token operator">-</span><span class="token operator">></span><span class="token function">mobile</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n        <span class="token operator">-</span><span class="token operator">></span><span class="token function">touch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n        <span class="token operator">-</span><span class="token operator">></span><span class="token function">setDelay</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>\n        <span class="token operator">-</span><span class="token operator">></span><span class="token function">save</span><span class="token punctuation">(</span><span class="token function">public_path</span><span class="token punctuation">(</span><span class="token single-quoted-string string">\'images/toutiao.jpg\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n\x3c!--beforeend--\x3e</div>\x3c!--afterend--\x3e<p><img src="https://raw.githubusercontent.com/tianyong90/blog/gh-pages/_nuxt/posts/Laravel-%E4%B8%AD%E4%BD%BF%E7%94%A8-puppeteer-%E9%87%87%E9%9B%86%E5%BC%82%E6%AD%A5%E5%8A%A0%E8%BD%BD%E7%9A%84%E7%BD%91%E9%A1%B5%E5%86%85%E5%AE%B9/toutiao.jpg" alt="ç»“æœ"></p>\n<p>å›¾ç‰‡é‡Œé‚£äº›æ¡†ä¸ç³»ç»Ÿå­—ä½“æœ‰å…³ã€‚ä»£ç ä¸­ä½¿ç”¨äº†ä¸€ä¸ª setDelay() æ–¹æ³•ï¼Œæ˜¯ä¸ºäº†è®©å†…å®¹åŠ è½½å®Œæˆåå†è¿›è¡Œæˆªå›¾ï¼Œç®€å•ç²—æš´ï¼Œå¯èƒ½ä¸æ˜¯æœ€å¥½çš„è§£å†³åŠæ³•ã€‚</p>\n<h2 id="å¯èƒ½å‡ºç°çš„é—®é¢˜"><a class="header-anchor" href="#å¯èƒ½å‡ºç°çš„é—®é¢˜">#</a> å¯èƒ½å‡ºç°çš„é—®é¢˜</h2>\n<ul>\n<li>\n<p>ç³»ç»Ÿå¾—æ”¯æŒ Chromium æµè§ˆå™¨ï¼Œå½“ç„¶ç°åœ¨ç»å¤§éƒ¨åˆ†æµè§ˆå™¨æ˜¯æ”¯æŒçš„ï¼Œè¦ä¸ç„¶ä¹Ÿæ²¡æ³•ï¼Œè¿˜æ˜¯ç”¨ PhantomJS å§ã€‚</p>\n</li>\n<li>\n<p>é¡¹ç›®ä¸­å®‰è£…äº† puppeteer åè°ƒç”¨æ—¶æœ‰å¯èƒ½å‡ºç°æƒé™é—®é¢˜ï¼Œè¿™å°±éœ€è¦å¯¹é¡¹ç›®ä¸‹ /node_modules/puppeteer ç›®å½•èµ‹äºˆé€‚å½“çš„æƒé™ã€‚</p>\n</li>\n</ul>\n<h2 id="æ€»ç»“"><a class="header-anchor" href="#æ€»ç»“">#</a> æ€»ç»“</h2>\n<p>puppeteer è¢«åº”ç”¨äºæµ‹è¯•ã€é‡‡é›†ç­‰åœºæ™¯ï¼Œæ˜¯ä¸€ä¸ªéå¸¸æœ‰åŠ›çš„å·¥å…·ã€‚å¯¹äºè½»åº¦çš„é‡‡é›†ä»»åŠ¡ï¼Œæ˜¯å¤Ÿç”¨çš„ï¼Œæ¯”å¦‚æœ¬æ–‡è¿™ç±»åœ¨ Laravel (php) é‡Œæ¥ç”¨é‡‡é›†ä¸€äº›å°é¡µé¢ï¼Œä½†å¦‚æœéœ€è¦å¿«é€Ÿé‡‡é›†å¤§é‡å†…å®¹ï¼Œè¿˜æ˜¯ Python å•¥çš„å§ã€‚ğŸ˜„</p>\n',prevLink:"/posts/zi-ji-lu-ge-vue-markdown-loader",nextLink:"/posts/ye-lai-che-che-vue-dan-yuan-ce-shi"}],fetch:[],error:null,state:{dropdownMenuVisible:!1,postCount:0,updatedAt:""},serverRendered:!0,routePath:"/posts/laravel-zhong-shi-yong-puppeteer-cai-ji-yi-bu-jia-zai-de-wang-ye-nei-rong"}</script><script src="/_nuxt/01bcce01f8c790f5d374.js" defer></script><script src="/_nuxt/07bd7fabb502977506dc.js" defer></script><script src="/_nuxt/105c752e7a97439a686c.js" defer></script><script src="/_nuxt/21062646b9e158167d36.js" defer></script><script src="/_nuxt/d1fd124a92a019d40dff.js" defer></script>
</body>
</html>
