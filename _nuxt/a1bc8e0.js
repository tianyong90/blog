(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{246:function(n,e){n.exports={html:'<p><img src="./install_puppeteer.jpg" alt="install puppeteer"></p>\n<p>é‡‡é›†ç½‘é¡µå†…å®¹æ˜¯ä¸€é¡¹å¾ˆå¸¸è§çš„éœ€æ±‚ï¼Œæ¯”è¾ƒä¼ ç»Ÿçš„é™æ€é¡µé¢ï¼Œcurl å°±èƒ½æå®šã€‚ä½†å¦‚æœé¡µé¢ä¸­æœ‰åŠ¨æ€åŠ è½½çš„å†…å®¹ï¼Œæ¯”å¦‚æœ‰äº›é¡µé¢é‡Œé€šè¿‡ ajax åŠ è½½çš„æ–‡ç« æ­£æ–‡å†…å®¹ï¼Œåˆå¦‚æœæœ‰äº›é¡µé¢åŠ è½½å®Œæˆåè¿›è¡Œäº†ä¸€äº›é¢å¤–å¤„ç†ï¼ˆå›¾ç‰‡åœ°å€æ›¿æ¢ç­‰ç­‰â€¦â€¦ï¼‰è€Œä½ æƒ³é‡‡é›†è¿™äº›å¤„ç†è¿‡åçš„å†…å®¹ã€‚é‚£ä¹ˆç‰›é€¼é—ªé—ªçš„ curl ä¹ŸæŸæ‰‹æ— ç­–äº†ã€‚</p>\n<p>åšè¿‡ç±»ä¼¼éœ€æ±‚çš„äººå¯èƒ½ä¼šè¯´ï¼Œè€é“ï¼Œä¸Š PhantomJS å•Šï¼</p>\n<p>æ²¡é”™ï¼Œè¿™æ˜¯ä¸€ä¸ªåŠæ³•ï¼Œè€Œä¸”åœ¨ç›¸å½“é•¿çš„æ—¶é—´é‡Œ PhantomJS æ˜¯ä¸ºæ•°ä¸å¤šçš„èƒ½è§£å†³è¿™ç±»éœ€æ±‚çš„å·¥å…·é‡Œçš„ä½¼ä½¼è€…ã€‚</p>\n<p>ä½†ä»Šå¤©è¿™é‡Œè¦ä»‹ç»çš„æ˜¯ä¸€ä¸ªåæ¥å±…ä¸Šçš„å·¥å…· -- puppeteerï¼Œå®ƒæ˜¯éšç€ Chrome Headless æŠ€æœ¯å…´èµ·è€Œå¿«é€Ÿå‘å±•èµ·æ¥çš„ã€‚è€Œä¸”éå¸¸å…³é”®çš„æ˜¯ï¼Œpuppeteer ç”± Chrome çš„å®˜æ–¹å›¢é˜Ÿå¼€å‘å’Œç»´æŠ¤ï¼Œå¯ä»¥è¯´ç›¸å½“é è°±äº†ï¼</p>\n<p>puppeteer æ˜¯ä¸€ä¸ª js åŒ…ï¼Œè¦æƒ³åœ¨ Laravel ä¸­ä½¿ç”¨ï¼Œå¾—å€ŸåŠ©äºå¦ä¸€ç¥å™¨<code>spatie/browsershot</code>ã€‚</p>\n<h2 id="å®‰è£…"><a class="header-anchor" href="#å®‰è£…">#</a> å®‰è£…</h2>\n<ol>\n<li>\n<p>å®‰è£… <a href="https://github.com/spatie/browsershot">spatie/browsershot</a></p>\n<p>browsershot æ˜¯ä¸€ä¸ª composer åŒ…ï¼Œå‡ºè‡ªäºå¤§ç¥å›¢é˜Ÿ <a href="https://github.com/spatie">spatie</a></p>\n\x3c!--beforebegin--\x3e<div class="language-bash extra-class">\x3c!--afterbegin--\x3e<pre v-pre class="language-bash"><code>$ <span class="token function">composer</span> require spatie/browsershot\n</code></pre>\n\x3c!--beforeend--\x3e</div>\x3c!--afterend--\x3e</li>\n<li>\n<p>å®‰è£… <a href="https://github.com/GoogleChrome/puppeteer">puppeteer</a></p>\n\x3c!--beforebegin--\x3e<div class="language-shell extra-class">\x3c!--afterbegin--\x3e<pre v-pre class="language-shell"><code>$ <span class="token function">npm</span> i puppeteer --save\n</code></pre>\n\x3c!--beforeend--\x3e</div>\x3c!--afterend--\x3e<blockquote>\n<p><strong>ä¹Ÿå¯ä»¥å…¨å±€å®‰å…¨ puppeteer ä½†å°±ä¸ªäººç»éªŒè€Œè¨€ï¼Œåœ¨é¡¹ç›®ä¸­å®‰è£…æ˜¯æ¯”è¾ƒæ¨èçš„åšæ³•ï¼Œå› ä¸ºè¿™æ ·ä¸åŒé¡¹ç›®ä¸ä¼šåŒæ—¶å—å…¨å±€å®‰è£…çš„ puppeteer å½±å“ï¼Œæ­¤å¤–é¡¹ç›®ä¸­å®‰è£…ä¹Ÿæ–¹ä¾¿ä½¿ç”¨ phpdeployer è¿›è¡Œå‡çº§ï¼ˆphpdeploy å‡çº§æ—¶ä¸ä¼šå½±å“çº¿ä¸Šé¡¹ç›®è¿è¡Œï¼Œè¦çŸ¥é“å‡çº§/å®‰è£… puppeteer å¯æ˜¯å¾ˆè´¹æ—¶çš„ï¼Œæœ‰æ—¶å€™è¿˜ä¸èƒ½ä¿è¯ä¸€æ¬¡æˆåŠŸï¼‰ã€‚</strong>\nå®‰è£… puppeteer æ—¶ä¼šä¸‹è½½ Chromium-Browserï¼Œé‰´äºå’±ç‰¹æ®Šå›½æƒ…ï¼Œå¾ˆæœ‰å¯èƒ½å‡ºç°æ— æ³•ä¸‹è½½çš„æƒ…å†µï¼Œå¯¹æ­¤ï¼Œå°±è¯·å¤§å®¶å„æ˜¾ç¥é€šå§â€¦â€¦</p>\n</blockquote>\n</li>\n</ol>\n<h2 id="ä½¿ç”¨"><a class="header-anchor" href="#ä½¿ç”¨">#</a> ä½¿ç”¨</h2>\n<p>ä»¥é‡‡é›†ä»Šæ—¥å¤´æ¡æ‰‹æœºç‰ˆé¡µé¢æ–‡ç« å†…å®¹ä¸ºä¾‹ã€‚</p>\n\x3c!--beforebegin--\x3e<div class="language-php extra-class">\x3c!--afterbegin--\x3e<pre v-pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">Spatie<span class="token punctuation">\\</span>Browsershot<span class="token punctuation">\\</span>Browsershot</span><span class="token punctuation">;</span>\n\n<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">getBodyHtml</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    <span class="token variable">$newsUrl</span> <span class="token operator">=</span> <span class="token single-quoted-string string">\'https://m.toutiao.com/i6546884151050502660/\'</span><span class="token punctuation">;</span>\n\n    <span class="token variable">$html</span> <span class="token operator">=</span> Browsershot<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">url</span><span class="token punctuation">(</span><span class="token variable">$newsUrl</span><span class="token punctuation">)</span>\n        <span class="token operator">-</span><span class="token operator">></span><span class="token function">windowSize</span><span class="token punctuation">(</span><span class="token number">480</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span>\n        <span class="token operator">-</span><span class="token operator">></span><span class="token function">userAgent</span><span class="token punctuation">(</span><span class="token single-quoted-string string">\'Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Mobile Safari/537.36\'</span><span class="token punctuation">)</span>\n        <span class="token operator">-</span><span class="token operator">></span><span class="token function">mobile</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n        <span class="token operator">-</span><span class="token operator">></span><span class="token function">touch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n        <span class="token operator">-</span><span class="token operator">></span><span class="token function">bodyHtml</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    \\<span class="token package">Log</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token variable">$html</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n\x3c!--beforeend--\x3e</div>\x3c!--afterend--\x3e<p>è¿è¡Œåå¯ä»¥åœ¨æ—¥å¿—ä¸­çœ‹åˆ°å¦‚ä¸‹å†…å®¹ï¼ˆæˆªå›¾ä¸­åªæ˜¯å…¶ä¸­éƒ¨åˆ†ï¼‰</p>\n<p><img src="./toutiao_log.jpg" alt="æ—¥å¿—"></p>\n<p>æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥å°†é¡µé¢ä¿å­˜ä¸ºå›¾ç‰‡æˆ– PDF æ–‡ä»¶ã€‚</p>\n\x3c!--beforebegin--\x3e<div class="language-php extra-class">\x3c!--afterbegin--\x3e<pre v-pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">Spatie<span class="token punctuation">\\</span>Browsershot<span class="token punctuation">\\</span>Browsershot</span><span class="token punctuation">;</span>\n\n<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">getBodyHtml</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    <span class="token variable">$newsUrl</span> <span class="token operator">=</span> <span class="token single-quoted-string string">\'https://m.toutiao.com/i6546884151050502660/\'</span><span class="token punctuation">;</span>\n\n    Browsershot<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">url</span><span class="token punctuation">(</span><span class="token variable">$newsUrl</span><span class="token punctuation">)</span>\n        <span class="token operator">-</span><span class="token operator">></span><span class="token function">windowSize</span><span class="token punctuation">(</span><span class="token number">480</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">)</span>\n        <span class="token operator">-</span><span class="token operator">></span><span class="token function">userAgent</span><span class="token punctuation">(</span><span class="token single-quoted-string string">\'Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.132 Mobile Safari/537.36\'</span><span class="token punctuation">)</span>\n        <span class="token operator">-</span><span class="token operator">></span><span class="token function">mobile</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n        <span class="token operator">-</span><span class="token operator">></span><span class="token function">touch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n        <span class="token operator">-</span><span class="token operator">></span><span class="token function">setDelay</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>\n        <span class="token operator">-</span><span class="token operator">></span><span class="token function">save</span><span class="token punctuation">(</span><span class="token function">public_path</span><span class="token punctuation">(</span><span class="token single-quoted-string string">\'images/toutiao.jpg\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre>\n\x3c!--beforeend--\x3e</div>\x3c!--afterend--\x3e<p><img src="./toutiao.jpg" alt="ç»“æœ"></p>\n<p>å›¾ç‰‡é‡Œé‚£äº›æ¡†ä¸ç³»ç»Ÿå­—ä½“æœ‰å…³ã€‚ä»£ç ä¸­ä½¿ç”¨äº†ä¸€ä¸ª setDelay() æ–¹æ³•ï¼Œæ˜¯ä¸ºäº†è®©å†…å®¹åŠ è½½å®Œæˆåå†è¿›è¡Œæˆªå›¾ï¼Œç®€å•ç²—æš´ï¼Œå¯èƒ½ä¸æ˜¯æœ€å¥½çš„è§£å†³åŠæ³•ã€‚</p>\n<h2 id="å¯èƒ½å‡ºç°çš„é—®é¢˜"><a class="header-anchor" href="#å¯èƒ½å‡ºç°çš„é—®é¢˜">#</a> å¯èƒ½å‡ºç°çš„é—®é¢˜</h2>\n<ul>\n<li>\n<p>ç³»ç»Ÿå¾—æ”¯æŒ Chromium æµè§ˆå™¨ï¼Œå½“ç„¶ç°åœ¨ç»å¤§éƒ¨åˆ†æµè§ˆå™¨æ˜¯æ”¯æŒçš„ï¼Œè¦ä¸ç„¶ä¹Ÿæ²¡æ³•ï¼Œè¿˜æ˜¯ç”¨ PhantomJS å§ã€‚</p>\n</li>\n<li>\n<p>é¡¹ç›®ä¸­å®‰è£…äº† puppeteer åè°ƒç”¨æ—¶æœ‰å¯èƒ½å‡ºç°æƒé™é—®é¢˜ï¼Œè¿™å°±éœ€è¦å¯¹é¡¹ç›®ä¸‹ /node_modules/puppeteer ç›®å½•èµ‹äºˆé€‚å½“çš„æƒé™ã€‚</p>\n</li>\n</ul>\n<h2 id="æ€»ç»“"><a class="header-anchor" href="#æ€»ç»“">#</a> æ€»ç»“</h2>\n<p>puppeteer è¢«åº”ç”¨äºæµ‹è¯•ã€é‡‡é›†ç­‰åœºæ™¯ï¼Œæ˜¯ä¸€ä¸ªéå¸¸æœ‰åŠ›çš„å·¥å…·ã€‚å¯¹äºè½»åº¦çš„é‡‡é›†ä»»åŠ¡ï¼Œæ˜¯å¤Ÿç”¨çš„ï¼Œæ¯”å¦‚æœ¬æ–‡è¿™ç±»åœ¨ Laravel (php) é‡Œæ¥ç”¨é‡‡é›†ä¸€äº›å°é¡µé¢ï¼Œä½†å¦‚æœéœ€è¦å¿«é€Ÿé‡‡é›†å¤§é‡å†…å®¹ï¼Œè¿˜æ˜¯ Python å•¥çš„å§ã€‚ğŸ˜„</p>\n',attributes:{title:"Laravel ä¸­ä½¿ç”¨ puppeteer é‡‡é›†å¼‚æ­¥åŠ è½½çš„ç½‘é¡µå†…å®¹",date:"2019-03-10T16:44:31.000Z",top_img:"./top_img.png",tags:["laravel","puppeteer","é‡‡é›†"],categories:["php","Laravel"]}}}}]);